<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Markets | ECON 4-6260 Behavioral Economics</title>
  <meta name="description" content="7 Markets | ECON 4-6260 Behavioral Economics" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Markets | ECON 4-6260 Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Markets | ECON 4-6260 Behavioral Economics" />
  
  
  

<meta name="author" content="James Bland" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="guessing-game.html"/>
<link rel="next" href="risk.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html"><i class="fa fa-check"></i>Common content (both ECON 4260 and ECON 6260)</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#boring-stuff-first-expectation-for-class"><i class="fa fa-check"></i><b>1.1</b> Boring stuff first: Expectation for class</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-will-we-be-studying"><i class="fa fa-check"></i><b>1.2</b> What will we be studying?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#doing-economic-research-without-experiments"><i class="fa fa-check"></i><b>1.3</b> Doing economic research without experiments</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#economic-experiments"><i class="fa fa-check"></i><b>1.4</b> Economic experiments</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#why-pay-money"><i class="fa fa-check"></i><b>1.5</b> Why pay money?</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#how-this-will-work-for-econ46260"><i class="fa fa-check"></i><b>1.6</b> How this will work for ECON4/6260</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#and-now-for-our-first-experiment"><i class="fa fa-check"></i><b>1.7</b> And now for our first experiment</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#reasons-for-running-an-experiment"><i class="fa fa-check"></i><b>1.8</b> Reasons for running an experiment</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#studying-theoretical-predictions---i"><i class="fa fa-check"></i><b>1.9</b> Studying theoretical predictions - I</a></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#studying-theoretical-predictions---ii"><i class="fa fa-check"></i><b>1.10</b> Studying theoretical predictions - II</a></li>
<li class="chapter" data-level="1.11" data-path="introduction.html"><a href="introduction.html#studying-theoretical-predictions---iii"><i class="fa fa-check"></i><b>1.11</b> Studying theoretical predictions - III</a></li>
<li class="chapter" data-level="1.12" data-path="introduction.html"><a href="introduction.html#studying-theoretical-predictions---iv"><i class="fa fa-check"></i><b>1.12</b> Studying theoretical predictions - IV</a></li>
<li class="chapter" data-level="1.13" data-path="introduction.html"><a href="introduction.html#economic-experiments-and-causality"><i class="fa fa-check"></i><b>1.13</b> Economic experiments and causality</a></li>
<li class="chapter" data-level="1.14" data-path="introduction.html"><a href="introduction.html#complement-to-data-from-outside-the-lab"><i class="fa fa-check"></i><b>1.14</b> Complement to data from outside the lab</a></li>
<li class="chapter" data-level="1.15" data-path="introduction.html"><a href="introduction.html#a-roadmap-for-this-course"><i class="fa fa-check"></i><b>1.15</b> A roadmap for this course</a></li>
<li class="chapter" data-level="1.16" data-path="introduction.html"><a href="introduction.html#outline-of-topics-covered-not-necessarily-in-order"><i class="fa fa-check"></i><b>1.16</b> Outline of topics covered (not necessarily in order)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="markets.html"><a href="markets.html"><i class="fa fa-check"></i><b>2</b> Markets</a><ul>
<li class="chapter" data-level="2.1" data-path="markets.html"><a href="markets.html#markets-1"><i class="fa fa-check"></i><b>2.1</b> Markets</a></li>
<li class="chapter" data-level="2.2" data-path="markets.html"><a href="markets.html#an-experiment"><i class="fa fa-check"></i><b>2.2</b> An experiment</a></li>
<li class="chapter" data-level="2.3" data-path="markets.html"><a href="markets.html#induced-value-theory"><i class="fa fa-check"></i><b>2.3</b> Induced value theory</a></li>
<li class="chapter" data-level="2.4" data-path="markets.html"><a href="markets.html#in-market-experiments"><i class="fa fa-check"></i><b>2.4</b> In market experiments</a></li>
<li class="chapter" data-level="2.5" data-path="markets.html"><a href="markets.html#numerical-example---buyers"><i class="fa fa-check"></i><b>2.5</b> Numerical example - Buyers</a></li>
<li class="chapter" data-level="2.6" data-path="markets.html"><a href="markets.html#numerical-example---sellers"><i class="fa fa-check"></i><b>2.6</b> Numerical example - Sellers</a></li>
<li class="chapter" data-level="2.7" data-path="markets.html"><a href="markets.html#numerical-example---supply-and-demand-curves"><i class="fa fa-check"></i><b>2.7</b> Numerical example - Supply and demand curves</a></li>
<li class="chapter" data-level="2.8" data-path="markets.html"><a href="markets.html#point-predictions-from-markets"><i class="fa fa-check"></i><b>2.8</b> Point predictions from markets</a></li>
<li class="chapter" data-level="2.9" data-path="markets.html"><a href="markets.html#point-predictions"><i class="fa fa-check"></i><b>2.9</b> Point predictions</a></li>
<li class="chapter" data-level="2.10" data-path="markets.html"><a href="markets.html#comparative-static-predictions"><i class="fa fa-check"></i><b>2.10</b> Comparative static predictions</a></li>
<li class="chapter" data-level="2.11" data-path="markets.html"><a href="markets.html#other-take-aways"><i class="fa fa-check"></i><b>2.11</b> Other take-aways</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="risk-and-decision-making.html"><a href="risk-and-decision-making.html"><i class="fa fa-check"></i><b>3</b> Risk and decision-making</a><ul>
<li class="chapter" data-level="3.1" data-path="risk-and-decision-making.html"><a href="risk-and-decision-making.html#risk-and-uncertainty"><i class="fa fa-check"></i><b>3.1</b> Risk and uncertainty</a></li>
<li class="chapter" data-level="3.2" data-path="risk-and-decision-making.html"><a href="risk-and-decision-making.html#example-insurance"><i class="fa fa-check"></i><b>3.2</b> Example: Insurance</a></li>
<li class="chapter" data-level="3.3" data-path="risk-and-decision-making.html"><a href="risk-and-decision-making.html#expected-value"><i class="fa fa-check"></i><b>3.3</b> Expected value</a></li>
<li class="chapter" data-level="3.4" data-path="risk-and-decision-making.html"><a href="risk-and-decision-making.html#expected-value-1"><i class="fa fa-check"></i><b>3.4</b> Expected Value</a></li>
<li class="chapter" data-level="3.5" data-path="risk-and-decision-making.html"><a href="risk-and-decision-making.html#but-most-people-care-about-risk"><i class="fa fa-check"></i><b>3.5</b> But most people care about risk!</a></li>
<li class="chapter" data-level="3.6" data-path="risk-and-decision-making.html"><a href="risk-and-decision-making.html#expected-utility-theory"><i class="fa fa-check"></i><b>3.6</b> Expected utility theory</a></li>
<li class="chapter" data-level="3.7" data-path="risk-and-decision-making.html"><a href="risk-and-decision-making.html#insurance-with-risk-aversion"><i class="fa fa-check"></i><b>3.7</b> Insurance with risk aversion</a></li>
<li class="chapter" data-level="3.8" data-path="risk-and-decision-making.html"><a href="risk-and-decision-making.html#insurance-with-risk-aversion---graphically"><i class="fa fa-check"></i><b>3.8</b> Insurance with risk aversion - graphically</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>4</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="4.1" data-path="bayes-rule.html"><a href="bayes-rule.html#in-comparison-to-chapter-3-risk"><i class="fa fa-check"></i><b>4.1</b> In comparison to Chapter 3 (risk)</a></li>
<li class="chapter" data-level="4.2" data-path="bayes-rule.html"><a href="bayes-rule.html#conditional-probability"><i class="fa fa-check"></i><b>4.2</b> Conditional probability</a></li>
<li class="chapter" data-level="4.3" data-path="bayes-rule.html"><a href="bayes-rule.html#example"><i class="fa fa-check"></i><b>4.3</b> Example</a></li>
<li class="chapter" data-level="4.4" data-path="bayes-rule.html"><a href="bayes-rule.html#more-generally"><i class="fa fa-check"></i><b>4.4</b> More generally</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="masters-only-content-econ-6260.html"><a href="masters-only-content-econ-6260.html"><i class="fa fa-check"></i>Masters-only content (ECON 6260)</a></li>
<li class="chapter" data-level="5" data-path="reading-which-is-the-fair-sex.html"><a href="reading-which-is-the-fair-sex.html"><i class="fa fa-check"></i><b>5</b> Reading: Which is the fair sex?</a><ul>
<li class="chapter" data-level="5.1" data-path="reading-which-is-the-fair-sex.html"><a href="reading-which-is-the-fair-sex.html#plot-the-budget-sets"><i class="fa fa-check"></i><b>5.1</b> plot the budget sets</a></li>
<li class="chapter" data-level="5.2" data-path="reading-which-is-the-fair-sex.html"><a href="reading-which-is-the-fair-sex.html#classification-into-3-types-of-subject"><i class="fa fa-check"></i><b>5.2</b> Classification into 3 types of subject</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="problem-sets.html"><a href="problem-sets.html"><i class="fa fa-check"></i>Problem sets</a></li>
<li class="chapter" data-level="6" data-path="guessing-game.html"><a href="guessing-game.html"><i class="fa fa-check"></i><b>6</b> Guessing Game</a><ul>
<li class="chapter" data-level="6.1" data-path="guessing-game.html"><a href="guessing-game.html#a-description-of-what-happened"><i class="fa fa-check"></i><b>6.1</b> A description of what happened</a></li>
<li class="chapter" data-level="6.2" data-path="guessing-game.html"><a href="guessing-game.html#your-homework-assignment"><i class="fa fa-check"></i><b>6.2</b> Your homework assignment</a><ul>
<li class="chapter" data-level="6.2.1" data-path="guessing-game.html"><a href="guessing-game.html#solutions"><i class="fa fa-check"></i><b>6.2.1</b> Solutions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markets-2.html"><a href="markets-2.html"><i class="fa fa-check"></i><b>7</b> Markets</a><ul>
<li class="chapter" data-level="7.1" data-path="markets-2.html"><a href="markets-2.html#your-homework-assignment-1"><i class="fa fa-check"></i><b>7.1</b> Your homework assignment</a></li>
<li class="chapter" data-level="7.2" data-path="markets-2.html"><a href="markets-2.html#solutions-1"><i class="fa fa-check"></i><b>7.2</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="risk.html"><a href="risk.html"><i class="fa fa-check"></i><b>8</b> Risk</a><ul>
<li class="chapter" data-level="8.1" data-path="risk.html"><a href="risk.html#questions"><i class="fa fa-check"></i><b>8.1</b> Questions</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ECON 4-6260 Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="markets-2" class="section level1">
<h1><span class="header-section-number">7</span> Markets</h1>
<div id="your-homework-assignment-1" class="section level2">
<h2><span class="header-section-number">7.1</span> Your homework assignment</h2>
<ol style="list-style-type: decimal">
<li><p>What could have happened in the market between Parts 1 and 2? Tell me one thing the government could have done to make this change, and one thing that could have happened not involving the market.</p></li>
<li><p>Draw the supply and demand curves for both parts of the experiment. Label equilibrium price and quantity</p></li>
<li><p>On a separate plot, show every trade price for every round. Include your predicted prices from Part 1.
(this is a deliberately vague question, I am asking you to think about how to communicate the results of this experiment graphically)</p></li>
<li><p>Compute the predicted producer, consumer, and total surplus in both parts. Compare these to the actual consumer, producer, and total surplus from the experiment (dividing this up by round).</p></li>
<li><p>Write a short paragraph telling me your main findings. When needed, make reference to the three plots you made.</p></li>
<li><p>(6260 students only) The model also makes predictions about how many items each seller will sell, and how many items each buyer will buy. Comment on how well the theory is predicting these individual-level quantities (Again, this is another deliberately vague question. I am looking to see how you approach this problem)</p></li>
</ol>
</div>
<div id="solutions-1" class="section level2">
<h2><span class="header-section-number">7.2</span> Solutions</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="markets-2.html#cb20-1"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb20-2"><a href="markets-2.html#cb20-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb20-3"><a href="markets-2.html#cb20-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb20-4"><a href="markets-2.html#cb20-4"></a>DRaw&lt;-<span class="kw">data.frame</span>(<span class="kw">read.csv</span>(<span class="st">&quot;PS02data.csv&quot;</span>))</span>
<span id="cb20-5"><a href="markets-2.html#cb20-5"></a>D&lt;-(DRaw</span>
<span id="cb20-6"><a href="markets-2.html#cb20-6"></a>    <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_all</span>(<span class="dt">.funs =</span>as.numeric)</span>
<span id="cb20-7"><a href="markets-2.html#cb20-7"></a>    <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Part =</span> <span class="dv">1</span><span class="op">+</span>(Round<span class="op">&gt;=</span><span class="dv">6</span>))</span>
<span id="cb20-8"><a href="markets-2.html#cb20-8"></a>)</span>
<span id="cb20-9"><a href="markets-2.html#cb20-9"></a>D<span class="op">$</span>Status&lt;-<span class="kw">as.factor</span>(DRaw<span class="op">$</span>Status)</span>
<span id="cb20-10"><a href="markets-2.html#cb20-10"></a>D<span class="op">$</span>Role&lt;-<span class="st">&quot;Buyer&quot;</span></span>
<span id="cb20-11"><a href="markets-2.html#cb20-11"></a>D<span class="op">$</span>Role[<span class="kw">is.na</span>(D<span class="op">$</span>Value)]&lt;-<span class="st">&quot;Seller&quot;</span></span>
<span id="cb20-12"><a href="markets-2.html#cb20-12"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(D))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="6%" />
<col width="5%" />
<col width="2%" />
<col width="4%" />
<col width="5%" />
<col width="3%" />
<col width="4%" />
<col width="3%" />
<col width="6%" />
<col width="12%" />
<col width="8%" />
<col width="19%" />
<col width="4%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="right">Record</th>
<th align="right">Round</th>
<th align="right">ID</th>
<th align="right">Unit</th>
<th align="right">Value</th>
<th align="right">Bid</th>
<th align="right">Cost</th>
<th align="right">Ask</th>
<th align="left">Status</th>
<th align="right">Market_Price</th>
<th align="right">Earnings</th>
<th align="right">Cumulative_earnings</th>
<th align="right">Part</th>
<th align="left">Role</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">32</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">33</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">34</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="markets-2.html#cb21-1"></a>Parameters&lt;-<span class="kw">data.frame</span>(<span class="kw">read.csv</span>(<span class="st">&quot;PS02Parameters.csv&quot;</span>))</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>What could have happened in the market between Parts 1 and 2? Tell me one thing the government could have done to make this change, and one thing that could have happened not involving the market.</p></li>
<li><p>Draw the supply and demand curves for both parts of the experiment. Label equilibrium price and quantity</p></li>
</ol>
<p><strong>Solution</strong>: Here I will do questions 1 &amp; 2 together, as it helps to have the supply and demand diagram to work out what happened.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="markets-2.html#cb22-1"></a><span class="co"># extract values and costs from rounds 1 and 6</span></span>
<span id="cb22-2"><a href="markets-2.html#cb22-2"></a></span>
<span id="cb22-3"><a href="markets-2.html#cb22-3"></a>SupplyDemand&lt;-<span class="kw">data.frame</span>()</span>
<span id="cb22-4"><a href="markets-2.html#cb22-4"></a>EQ&lt;-<span class="kw">data.frame</span>()</span>
<span id="cb22-5"><a href="markets-2.html#cb22-5"></a>P&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(Parameters<span class="op">$</span>v, <span class="dt">na.rm=</span>T)<span class="op">+</span><span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb22-6"><a href="markets-2.html#cb22-6"></a></span>
<span id="cb22-7"><a href="markets-2.html#cb22-7"></a><span class="cf">for</span> (rr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) { </span>
<span id="cb22-8"><a href="markets-2.html#cb22-8"></a>  </span>
<span id="cb22-9"><a href="markets-2.html#cb22-9"></a>  <span class="co"># supply and demand functions</span></span>
<span id="cb22-10"><a href="markets-2.html#cb22-10"></a>  Qd&lt;-<span class="cf">function</span>(p,r) {</span>
<span id="cb22-11"><a href="markets-2.html#cb22-11"></a>    v&lt;-Parameters <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Part<span class="op">==</span>r) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(v) </span>
<span id="cb22-12"><a href="markets-2.html#cb22-12"></a>    <span class="kw">sum</span>(v<span class="op">&gt;=</span>p,<span class="dt">na.rm=</span>T)</span>
<span id="cb22-13"><a href="markets-2.html#cb22-13"></a>  }</span>
<span id="cb22-14"><a href="markets-2.html#cb22-14"></a>  Qs&lt;-<span class="cf">function</span>(p,r) {</span>
<span id="cb22-15"><a href="markets-2.html#cb22-15"></a>    c&lt;-Parameters  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Part<span class="op">==</span>r) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(c)</span>
<span id="cb22-16"><a href="markets-2.html#cb22-16"></a>    <span class="kw">sum</span>(c<span class="op">&lt;=</span>p,<span class="dt">na.rm=</span>T)</span>
<span id="cb22-17"><a href="markets-2.html#cb22-17"></a>  }</span>
<span id="cb22-18"><a href="markets-2.html#cb22-18"></a>  </span>
<span id="cb22-19"><a href="markets-2.html#cb22-19"></a></span>
<span id="cb22-20"><a href="markets-2.html#cb22-20"></a>  Q&lt;-<span class="kw">apply</span>(<span class="kw">as.matrix</span>(P),<span class="dv">1</span>,<span class="dt">FUN =</span> {<span class="cf">function</span>(p) <span class="kw">Qs</span>(p,rr)})</span>
<span id="cb22-21"><a href="markets-2.html#cb22-21"></a>  tmp&lt;-<span class="kw">data.frame</span>(P,Q)</span>
<span id="cb22-22"><a href="markets-2.html#cb22-22"></a>  tmp<span class="op">$</span>type=<span class="st">&quot;Supply&quot;</span></span>
<span id="cb22-23"><a href="markets-2.html#cb22-23"></a>  tmp<span class="op">$</span>Part =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Part&quot;</span>,rr)</span>
<span id="cb22-24"><a href="markets-2.html#cb22-24"></a>  SupplyDemand&lt;-<span class="kw">rbind</span>(SupplyDemand,tmp)</span>
<span id="cb22-25"><a href="markets-2.html#cb22-25"></a>  </span>
<span id="cb22-26"><a href="markets-2.html#cb22-26"></a>  ExcessDemand&lt;-Q</span>
<span id="cb22-27"><a href="markets-2.html#cb22-27"></a>  </span>
<span id="cb22-28"><a href="markets-2.html#cb22-28"></a>  </span>
<span id="cb22-29"><a href="markets-2.html#cb22-29"></a>  Q&lt;-<span class="kw">apply</span>(<span class="kw">as.matrix</span>(P),<span class="dv">1</span>,<span class="dt">FUN =</span> {<span class="cf">function</span>(p) <span class="kw">Qd</span>(p,rr)})</span>
<span id="cb22-30"><a href="markets-2.html#cb22-30"></a>  tmp&lt;-<span class="kw">data.frame</span>(P,Q)</span>
<span id="cb22-31"><a href="markets-2.html#cb22-31"></a>  tmp<span class="op">$</span>type=<span class="st">&quot;Demand&quot;</span></span>
<span id="cb22-32"><a href="markets-2.html#cb22-32"></a>  tmp<span class="op">$</span>Part =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Part&quot;</span>,rr)</span>
<span id="cb22-33"><a href="markets-2.html#cb22-33"></a>  SupplyDemand&lt;-<span class="kw">rbind</span>(SupplyDemand,tmp)</span>
<span id="cb22-34"><a href="markets-2.html#cb22-34"></a>  </span>
<span id="cb22-35"><a href="markets-2.html#cb22-35"></a>  ExcessDemand&lt;-<span class="st"> </span><span class="op">-</span>(ExcessDemand<span class="op">-</span>Q)</span>
<span id="cb22-36"><a href="markets-2.html#cb22-36"></a>  </span>
<span id="cb22-37"><a href="markets-2.html#cb22-37"></a>  ii&lt;-<span class="kw">sum</span>(<span class="dv">1</span><span class="op">*!</span>(ExcessDemand<span class="op">&lt;=</span><span class="dv">0</span>))</span>
<span id="cb22-38"><a href="markets-2.html#cb22-38"></a>  Peq&lt;-<span class="kw">round</span>(P[ii]) <span class="co"># I know there is an integer solution</span></span>
<span id="cb22-39"><a href="markets-2.html#cb22-39"></a>  Qeq&lt;-Q[ii]</span>
<span id="cb22-40"><a href="markets-2.html#cb22-40"></a>  </span>
<span id="cb22-41"><a href="markets-2.html#cb22-41"></a>  tmp&lt;-<span class="kw">data.frame</span>(Peq,Qeq)</span>
<span id="cb22-42"><a href="markets-2.html#cb22-42"></a>  tmp<span class="op">$</span>Part&lt;-<span class="kw">paste</span>(<span class="st">&quot;Part&quot;</span>,rr)</span>
<span id="cb22-43"><a href="markets-2.html#cb22-43"></a>  EQ&lt;-<span class="kw">rbind</span>(EQ,tmp) </span>
<span id="cb22-44"><a href="markets-2.html#cb22-44"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="markets-2.html#cb23-1"></a><span class="kw">print</span>(EQ)</span></code></pre></div>
<pre><code>##   Peq Qeq   Part
## 1   5  20 Part 1
## 2   6  16 Part 2</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="markets-2.html#cb25-1"></a>EQ<span class="op">$</span>type&lt;-<span class="st">&quot;Equilibrium&quot;</span></span>
<span id="cb25-2"><a href="markets-2.html#cb25-2"></a></span>
<span id="cb25-3"><a href="markets-2.html#cb25-3"></a>plt&lt;-(</span>
<span id="cb25-4"><a href="markets-2.html#cb25-4"></a>  <span class="kw">ggplot</span>(SupplyDemand,<span class="kw">aes</span>(<span class="dt">x=</span>Q,<span class="dt">y=</span>P,<span class="dt">color=</span>type,<span class="dt">group=</span><span class="kw">paste</span>(type,Part),<span class="dt">linetype=</span>Part))</span>
<span id="cb25-5"><a href="markets-2.html#cb25-5"></a>  <span class="op">+</span><span class="kw">geom_path</span>(<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">alpha=</span><span class="fl">0.8</span>)</span>
<span id="cb25-6"><a href="markets-2.html#cb25-6"></a>  <span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb25-7"><a href="markets-2.html#cb25-7"></a>  <span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Quantity&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Price ($)&quot;</span>)</span>
<span id="cb25-8"><a href="markets-2.html#cb25-8"></a>  <span class="op">+</span><span class="kw">geom_vline</span>(<span class="dt">data=</span>EQ,<span class="kw">aes</span>(<span class="dt">xintercept=</span>Qeq),<span class="dt">color=</span><span class="st">&quot;black&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb25-9"><a href="markets-2.html#cb25-9"></a>  <span class="op">+</span><span class="kw">geom_hline</span>(<span class="dt">data=</span>EQ,<span class="kw">aes</span>(<span class="dt">yintercept=</span>Peq),<span class="dt">color=</span><span class="st">&quot;black&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb25-10"><a href="markets-2.html#cb25-10"></a>  <span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">data=</span>EQ,<span class="kw">aes</span>(<span class="dt">x=</span>Qeq,<span class="dt">y=</span>Peq),<span class="dt">size=</span><span class="dv">4</span>)</span>
<span id="cb25-11"><a href="markets-2.html#cb25-11"></a>  <span class="co">#+theme(legend.position=&quot;none&quot;)</span></span>
<span id="cb25-12"><a href="markets-2.html#cb25-12"></a>)</span>
<span id="cb25-13"><a href="markets-2.html#cb25-13"></a><span class="kw">print</span>(plt)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>From the above Figure, we can see that supply has shifted to the left (or up, by $2). Two possible causes of this could be:</p>
<ul>
<li>The government imposes a $2 tax on sellers</li>
<li>An input cost increases</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>On a separate plot, show every trade price for every round. Include your predicted prices from Part 1.
(this is a deliberately vague question, I am asking you to think about how to communicate the results of this experiment graphically)</li>
</ol>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="markets-2.html#cb26-1"></a><span class="kw">library</span>(latex2exp)</span>
<span id="cb26-2"><a href="markets-2.html#cb26-2"></a>NewRound&lt;-<span class="kw">c</span>()</span>
<span id="cb26-3"><a href="markets-2.html#cb26-3"></a><span class="cf">for</span> (rr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</span>
<span id="cb26-4"><a href="markets-2.html#cb26-4"></a>  NewRound[rr]&lt;-<span class="st"> </span><span class="kw">max</span>((D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Round<span class="op">==</span>rr ))<span class="op">$</span>Record)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb26-5"><a href="markets-2.html#cb26-5"></a>}</span>
<span id="cb26-6"><a href="markets-2.html#cb26-6"></a></span>
<span id="cb26-7"><a href="markets-2.html#cb26-7"></a>Summary&lt;-(D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Record<span class="op">&gt;=</span><span class="dv">450</span> <span class="op">&amp;</span><span class="st"> </span>Status<span class="op">==</span><span class="st">&quot;t&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Round)</span>
<span id="cb26-8"><a href="markets-2.html#cb26-8"></a>                <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">summarize</span>(</span>
<span id="cb26-9"><a href="markets-2.html#cb26-9"></a>                      <span class="dt">m=</span><span class="kw">mean</span>(Bid,<span class="dt">na.rm=</span>T),</span>
<span id="cb26-10"><a href="markets-2.html#cb26-10"></a>                      <span class="dt">s=</span><span class="kw">sd</span>(Bid,<span class="dt">na.rm=</span>T))</span>
<span id="cb26-11"><a href="markets-2.html#cb26-11"></a>)</span>
<span id="cb26-12"><a href="markets-2.html#cb26-12"></a></span>
<span id="cb26-13"><a href="markets-2.html#cb26-13"></a>D &lt;-<span class="st"> </span>D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(Summary,<span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;Round&quot;</span>))</span>
<span id="cb26-14"><a href="markets-2.html#cb26-14"></a></span>
<span id="cb26-15"><a href="markets-2.html#cb26-15"></a>(</span>
<span id="cb26-16"><a href="markets-2.html#cb26-16"></a>  <span class="kw">ggplot</span>(D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Status<span class="op">==</span><span class="st">&quot;t&quot;</span>),<span class="kw">aes</span>(<span class="dt">x=</span>Record))</span>
<span id="cb26-17"><a href="markets-2.html#cb26-17"></a>  <span class="op">+</span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y=</span>Bid,<span class="dt">color=</span><span class="st">&quot;data&quot;</span>))</span>
<span id="cb26-18"><a href="markets-2.html#cb26-18"></a>  <span class="co">#+geom_line(aes(y=Bid,color=&quot;data&quot;))</span></span>
<span id="cb26-19"><a href="markets-2.html#cb26-19"></a>  <span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb26-20"><a href="markets-2.html#cb26-20"></a>  <span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Record,<span class="dt">y=</span>m,<span class="dt">group=</span>Round,<span class="dt">color=</span><span class="st">&quot;mean&quot;</span>))</span>
<span id="cb26-21"><a href="markets-2.html#cb26-21"></a>  <span class="op">+</span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Record,<span class="dt">ymax=</span>(m<span class="op">+</span>s),<span class="dt">ymin=</span>(m<span class="op">-</span>s),<span class="dt">fill=</span><span class="st">&quot;\U00B1 1 sd&quot;</span>),<span class="dt">alpha=</span><span class="fl">0.1</span>)</span>
<span id="cb26-22"><a href="markets-2.html#cb26-22"></a>  <span class="op">+</span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span>NewRound)</span>
<span id="cb26-23"><a href="markets-2.html#cb26-23"></a>  <span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">11</span>))</span>
<span id="cb26-24"><a href="markets-2.html#cb26-24"></a>  <span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Record,<span class="dt">y=</span>EQ<span class="op">$</span>Peq[Part],<span class="dt">group=</span>Part,<span class="dt">color=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb26-25"><a href="markets-2.html#cb26-25"></a>  <span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Traded price ($)&quot;</span>)</span>
<span id="cb26-26"><a href="markets-2.html#cb26-26"></a>  <span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Record number&quot;</span>)</span>
<span id="cb26-27"><a href="markets-2.html#cb26-27"></a>  <span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">10</span>))<span class="op">+</span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">500</span>,<span class="dv">1100</span>))</span>
<span id="cb26-28"><a href="markets-2.html#cb26-28"></a>  </span>
<span id="cb26-29"><a href="markets-2.html#cb26-29"></a>  </span>
<span id="cb26-30"><a href="markets-2.html#cb26-30"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Compute the predicted producer, consumer, and total surplus in both parts. Compare these to the actual consumer, producer, and total surplus from the experiment (dividing this up by round).</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="markets-2.html#cb27-1"></a><span class="co"># Surplus for each part</span></span>
<span id="cb27-2"><a href="markets-2.html#cb27-2"></a>Parameters&lt;-(Parameters</span>
<span id="cb27-3"><a href="markets-2.html#cb27-3"></a>             <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">EQ_CS =</span> v<span class="op">-</span>EQ<span class="op">$</span>Peq[Part],</span>
<span id="cb27-4"><a href="markets-2.html#cb27-4"></a>                        <span class="dt">EQ_PS =</span> EQ<span class="op">$</span>Peq[Part]<span class="op">-</span>c)</span>
<span id="cb27-5"><a href="markets-2.html#cb27-5"></a>                            </span>
<span id="cb27-6"><a href="markets-2.html#cb27-6"></a>             <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">EQ_CS =</span> EQ_CS<span class="op">*</span>(EQ_CS<span class="op">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb27-7"><a href="markets-2.html#cb27-7"></a>                        <span class="dt">EQ_PS =</span> EQ_PS<span class="op">*</span>(EQ_PS<span class="op">&gt;=</span><span class="dv">0</span>)</span>
<span id="cb27-8"><a href="markets-2.html#cb27-8"></a>                        )</span>
<span id="cb27-9"><a href="markets-2.html#cb27-9"></a>             </span>
<span id="cb27-10"><a href="markets-2.html#cb27-10"></a>  </span>
<span id="cb27-11"><a href="markets-2.html#cb27-11"></a>)</span>
<span id="cb27-12"><a href="markets-2.html#cb27-12"></a></span>
<span id="cb27-13"><a href="markets-2.html#cb27-13"></a>Surplus&lt;-(</span>
<span id="cb27-14"><a href="markets-2.html#cb27-14"></a>  Parameters </span>
<span id="cb27-15"><a href="markets-2.html#cb27-15"></a>  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Part) </span>
<span id="cb27-16"><a href="markets-2.html#cb27-16"></a>  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">CS =</span> <span class="kw">sum</span>(EQ_CS,<span class="dt">na.rm=</span>T),<span class="dt">PS =</span> <span class="kw">sum</span>(EQ_PS,<span class="dt">na.rm=</span>T)) </span>
<span id="cb27-17"><a href="markets-2.html#cb27-17"></a>  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">TS =</span> CS<span class="op">+</span>PS)</span>
<span id="cb27-18"><a href="markets-2.html#cb27-18"></a>    </span>
<span id="cb27-19"><a href="markets-2.html#cb27-19"></a>  </span>
<span id="cb27-20"><a href="markets-2.html#cb27-20"></a>)</span>
<span id="cb27-21"><a href="markets-2.html#cb27-21"></a></span>
<span id="cb27-22"><a href="markets-2.html#cb27-22"></a>knitr<span class="op">::</span><span class="kw">kable</span>(Surplus)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Part</th>
<th align="right">CS</th>
<th align="right">PS</th>
<th align="right">TS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">42</td>
<td align="right">42</td>
<td align="right">84</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">26</td>
<td align="right">24</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="markets-2.html#cb28-1"></a>D &lt;-<span class="st"> </span>(D</span>
<span id="cb28-2"><a href="markets-2.html#cb28-2"></a>      <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Status<span class="op">==</span><span class="st">&quot;t&quot;</span>)</span>
<span id="cb28-3"><a href="markets-2.html#cb28-3"></a>      <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Round)</span>
<span id="cb28-4"><a href="markets-2.html#cb28-4"></a>      <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">CumlativeSurplus =</span> <span class="kw">cumsum</span>(Earnings))</span>
<span id="cb28-5"><a href="markets-2.html#cb28-5"></a>)</span>
<span id="cb28-6"><a href="markets-2.html#cb28-6"></a></span>
<span id="cb28-7"><a href="markets-2.html#cb28-7"></a>(<span class="kw">ggplot</span>(D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Status<span class="op">==</span><span class="st">&quot;t&quot;</span>))</span>
<span id="cb28-8"><a href="markets-2.html#cb28-8"></a>        <span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Record,<span class="dt">y=</span>CumlativeSurplus,<span class="dt">group=</span>Round,<span class="dt">color=</span><span class="st">&quot;Data&quot;</span>))</span>
<span id="cb28-9"><a href="markets-2.html#cb28-9"></a>        <span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb28-10"><a href="markets-2.html#cb28-10"></a>        <span class="op">+</span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span>NewRound)</span>
<span id="cb28-11"><a href="markets-2.html#cb28-11"></a>        <span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Record,<span class="dt">y=</span>Surplus<span class="op">$</span>TS[Part],<span class="dt">group=</span>Part,<span class="dt">color=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb28-12"><a href="markets-2.html#cb28-12"></a>        <span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Cumulative surplus&quot;</span>)</span>
<span id="cb28-13"><a href="markets-2.html#cb28-13"></a>        )</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="markets-2.html#cb29-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb29-2"><a href="markets-2.html#cb29-2"></a>D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Round,Part)</span>
<span id="cb29-3"><a href="markets-2.html#cb29-3"></a><span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">FracSurplus =</span> <span class="kw">max</span>(CumlativeSurplus<span class="op">/</span>Surplus<span class="op">$</span>TS[Part],<span class="dt">na.rm=</span>T))</span>
<span id="cb29-4"><a href="markets-2.html#cb29-4"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Round</th>
<th align="right">Part</th>
<th align="right">FracSurplus</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0.3928571</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">0.7976190</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">0.7976190</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0.7500000</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">2</td>
<td align="right">0.6000000</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">2</td>
<td align="right">0.6600000</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">2</td>
<td align="right">0.8000000</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">2</td>
<td align="right">0.7200000</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">2</td>
<td align="right">0.7200000</td>
</tr>
</tbody>
</table>
<ol start="5" style="list-style-type: decimal">
<li>Write a short paragraph telling me your main findings. When needed, make reference to the three plots you made.</li>
</ol>
<p><strong>Solution</strong> We studied a market experiment in which buyers and sellers traded a fictitious good. In the second part of the experiment, the supply curve shifted up by $2 (see first Figure). In general, traded prices were above the equilibrium, but they moved up on average in the second part:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="markets-2.html#cb30-1"></a>(</span>
<span id="cb30-2"><a href="markets-2.html#cb30-2"></a><span class="kw">ggplot</span>(D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Status<span class="op">==</span><span class="st">&quot;t&quot;</span>),<span class="kw">aes</span>(<span class="dt">x=</span>Market_Price,<span class="dt">color=</span><span class="kw">paste</span>(<span class="st">&quot;Part&quot;</span>,Part),<span class="dt">linetype=</span><span class="st">&quot;Data&quot;</span>))</span>
<span id="cb30-3"><a href="markets-2.html#cb30-3"></a><span class="op">+</span><span class="kw">stat_ecdf</span>()</span>
<span id="cb30-4"><a href="markets-2.html#cb30-4"></a><span class="op">+</span><span class="kw">geom_vline</span>(<span class="dt">data=</span>EQ,<span class="kw">aes</span>(<span class="dt">xintercept=</span>Peq,<span class="dt">color=</span>Part,<span class="dt">linetype=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb30-5"><a href="markets-2.html#cb30-5"></a><span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb30-6"><a href="markets-2.html#cb30-6"></a><span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;p&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">Pr(</span><span class="ch">\\</span><span class="st">mathrm{Trade Price}) </span><span class="ch">\\</span><span class="st">leq p$&quot;</span>))</span>
<span id="cb30-7"><a href="markets-2.html#cb30-7"></a></span>
<span id="cb30-8"><a href="markets-2.html#cb30-8"></a></span>
<span id="cb30-9"><a href="markets-2.html#cb30-9"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<ol start="6" style="list-style-type: decimal">
<li>(6260 students only) The model also makes predictions about how many items each seller will sell, and how many items each buyer will buy. Comment on how well the theory is predicting these individual-level quantities (Again, this is another deliberately vague question. I am looking to see how you approach this problem)</li>
</ol>
<p><strong>Solution</strong></p>
<p>First, let’s make a list of how many items each buyer and seller should trade in equilibrium</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="markets-2.html#cb31-1"></a>Parameters&lt;-(Parameters</span>
<span id="cb31-2"><a href="markets-2.html#cb31-2"></a>             <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">ShouldBuy =</span> v<span class="op">&gt;=</span><span class="st"> </span>EQ<span class="op">$</span>Peq[Part],</span>
<span id="cb31-3"><a href="markets-2.html#cb31-3"></a>                        <span class="dt">ShouldSell =</span> c<span class="op">&lt;=</span><span class="st"> </span>EQ<span class="op">$</span>Peq[Part])</span>
<span id="cb31-4"><a href="markets-2.html#cb31-4"></a>)</span>
<span id="cb31-5"><a href="markets-2.html#cb31-5"></a>EQQdemand&lt;-Parameters <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(idBuyer,Part) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">qEQ =</span> <span class="kw">sum</span>(<span class="dv">1</span><span class="op">*</span>ShouldBuy)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">ID=</span>idBuyer,<span class="dt">Role=</span><span class="st">&quot;Buyer&quot;</span>) </span>
<span id="cb31-6"><a href="markets-2.html#cb31-6"></a>EQQsupply&lt;-Parameters <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(idSeller,Part) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">qEQ =</span> <span class="kw">sum</span>(<span class="dv">1</span><span class="op">*</span>ShouldSell)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">ID=</span>idSeller,<span class="dt">Role=</span><span class="st">&quot;Seller&quot;</span>) </span>
<span id="cb31-7"><a href="markets-2.html#cb31-7"></a>EQindividual&lt;-<span class="kw">rbind</span>(EQQdemand,EQQsupply)[,<span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>,<span class="st">&quot;Part&quot;</span>,<span class="st">&quot;qEQ&quot;</span>,<span class="st">&quot;Role&quot;</span>)] </span>
<span id="cb31-8"><a href="markets-2.html#cb31-8"></a><span class="co">#knitr::kable((EQindividual))</span></span></code></pre></div>
<p>Now, let’s work out what these were empirically:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="markets-2.html#cb32-1"></a>TradeCounts&lt;-(D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Status<span class="op">==</span><span class="st">&quot;t&quot;</span>)</span>
<span id="cb32-2"><a href="markets-2.html#cb32-2"></a>              <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Round,Part,ID,Role)</span>
<span id="cb32-3"><a href="markets-2.html#cb32-3"></a>              <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">ntrades=</span><span class="kw">n</span>())</span>
<span id="cb32-4"><a href="markets-2.html#cb32-4"></a>              <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(EQindividual,<span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>,<span class="st">&quot;Part&quot;</span>,<span class="st">&quot;Role&quot;</span>))</span>
<span id="cb32-5"><a href="markets-2.html#cb32-5"></a>              <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Part,qEQ,Round)</span>
<span id="cb32-6"><a href="markets-2.html#cb32-6"></a>              <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mtrades=</span><span class="kw">mean</span>(ntrades,<span class="dt">na.rm=</span>T,<span class="dt">sdtrades=</span><span class="kw">sd</span>(ntrades)))</span>
<span id="cb32-7"><a href="markets-2.html#cb32-7"></a>              )</span>
<span id="cb32-8"><a href="markets-2.html#cb32-8"></a></span>
<span id="cb32-9"><a href="markets-2.html#cb32-9"></a>(<span class="kw">ggplot</span>(<span class="dt">data=</span>TradeCounts,<span class="kw">aes</span>(<span class="dt">x=</span>Round,<span class="dt">y=</span>mtrades,<span class="dt">color=</span><span class="kw">paste</span>(qEQ)))</span>
<span id="cb32-10"><a href="markets-2.html#cb32-10"></a>  <span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype=</span><span class="st">&quot;Data&quot;</span>),<span class="dt">size=</span><span class="dv">1</span>)</span>
<span id="cb32-11"><a href="markets-2.html#cb32-11"></a>  <span class="op">+</span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span><span class="dv">1</span>,<span class="dt">color=</span><span class="st">&quot;1&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb32-12"><a href="markets-2.html#cb32-12"></a>  <span class="op">+</span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span><span class="dv">2</span>,<span class="dt">color=</span><span class="st">&quot;2&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb32-13"><a href="markets-2.html#cb32-13"></a>  <span class="op">+</span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span><span class="dv">3</span>,<span class="dt">color=</span><span class="st">&quot;3&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb32-14"><a href="markets-2.html#cb32-14"></a>  <span class="op">+</span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept=</span><span class="fl">5.5</span>),<span class="dt">color=</span><span class="st">&quot;black&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb32-15"><a href="markets-2.html#cb32-15"></a>  <span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb32-16"><a href="markets-2.html#cb32-16"></a>  <span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Mean number of trades&quot;</span>)</span>
<span id="cb32-17"><a href="markets-2.html#cb32-17"></a>  <span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb32-18"><a href="markets-2.html#cb32-18"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>The theory is not predicting the number of items each player will trade well. For example, in the first part of the experiment, the players who should make 2 trades on average trade more than those who should trade two.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="guessing-game.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="risk.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
