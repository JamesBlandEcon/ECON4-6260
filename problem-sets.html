<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Problem sets | ECON 4-6260 Behavioral Economics</title>
  <meta name="description" content="3 Problem sets | ECON 4-6260 Behavioral Economics" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Problem sets | ECON 4-6260 Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Problem sets | ECON 4-6260 Behavioral Economics" />
  
  
  

<meta name="author" content="James Bland" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="masters-only-content-econ-6260.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html"><i class="fa fa-check"></i><b>1</b> Common content (both ECON 4260 and ECON 6260)</a><ul>
<li class="chapter" data-level="1.1" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1.1" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#boring-stuff-first-expectation-for-class"><i class="fa fa-check"></i><b>1.1.1</b> Boring stuff first: Expectation for class</a></li>
<li class="chapter" data-level="1.1.2" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#what-will-we-be-studying"><i class="fa fa-check"></i><b>1.1.2</b> What will we be studying?</a></li>
<li class="chapter" data-level="1.1.3" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#doing-economic-research-without-experiments"><i class="fa fa-check"></i><b>1.1.3</b> Doing economic research without experiments</a></li>
<li class="chapter" data-level="1.1.4" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#economic-experiments"><i class="fa fa-check"></i><b>1.1.4</b> Economic experiments</a></li>
<li class="chapter" data-level="1.1.5" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#why-pay-money"><i class="fa fa-check"></i><b>1.1.5</b> Why pay money?</a></li>
<li class="chapter" data-level="1.1.6" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#how-this-will-work-for-econ46260"><i class="fa fa-check"></i><b>1.1.6</b> How this will work for ECON4/6260</a></li>
<li class="chapter" data-level="1.1.7" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#and-now-for-our-first-experiment"><i class="fa fa-check"></i><b>1.1.7</b> And now for our first experiment</a></li>
<li class="chapter" data-level="1.1.8" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#reasons-for-running-an-experiment"><i class="fa fa-check"></i><b>1.1.8</b> Reasons for running an experiment</a></li>
<li class="chapter" data-level="1.1.9" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#studying-theoretical-predictions---i"><i class="fa fa-check"></i><b>1.1.9</b> Studying theoretical predictions - I</a></li>
<li class="chapter" data-level="1.1.10" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#studying-theoretical-predictions---ii"><i class="fa fa-check"></i><b>1.1.10</b> Studying theoretical predictions - II</a></li>
<li class="chapter" data-level="1.1.11" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#studying-theoretical-predictions---iii"><i class="fa fa-check"></i><b>1.1.11</b> Studying theoretical predictions - III</a></li>
<li class="chapter" data-level="1.1.12" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#studying-theoretical-predictions---iv"><i class="fa fa-check"></i><b>1.1.12</b> Studying theoretical predictions - IV</a></li>
<li class="chapter" data-level="1.1.13" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#economic-experiments-and-causality"><i class="fa fa-check"></i><b>1.1.13</b> Economic experiments and causality</a></li>
<li class="chapter" data-level="1.1.14" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#complement-to-data-from-outside-the-lab"><i class="fa fa-check"></i><b>1.1.14</b> Complement to data from outside the lab</a></li>
<li class="chapter" data-level="1.1.15" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#a-roadmap-for-this-course"><i class="fa fa-check"></i><b>1.1.15</b> A roadmap for this course</a></li>
<li class="chapter" data-level="1.1.16" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#outline-of-topics-covered-not-necessarily-in-order"><i class="fa fa-check"></i><b>1.1.16</b> Outline of topics covered (not necessarily in order)</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#markets"><i class="fa fa-check"></i><b>1.2</b> Markets</a><ul>
<li class="chapter" data-level="1.2.1" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#markets-1"><i class="fa fa-check"></i><b>1.2.1</b> Markets</a></li>
<li class="chapter" data-level="1.2.2" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#an-experiment"><i class="fa fa-check"></i><b>1.2.2</b> An experiment</a></li>
<li class="chapter" data-level="1.2.3" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#induced-value-theory"><i class="fa fa-check"></i><b>1.2.3</b> Induced value theory</a></li>
<li class="chapter" data-level="1.2.4" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#in-market-experiments"><i class="fa fa-check"></i><b>1.2.4</b> In market experiments</a></li>
<li class="chapter" data-level="1.2.5" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#numerical-example---buyers"><i class="fa fa-check"></i><b>1.2.5</b> Numerical example - Buyers</a></li>
<li class="chapter" data-level="1.2.6" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#numerical-example---sellers"><i class="fa fa-check"></i><b>1.2.6</b> Numerical example - Sellers</a></li>
<li class="chapter" data-level="1.2.7" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#numerical-example---supply-and-demand-curves"><i class="fa fa-check"></i><b>1.2.7</b> Numerical example - Supply and demand curves</a></li>
<li class="chapter" data-level="1.2.8" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#point-predictions-from-markets"><i class="fa fa-check"></i><b>1.2.8</b> Point predictions from markets</a></li>
<li class="chapter" data-level="1.2.9" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#point-predictions"><i class="fa fa-check"></i><b>1.2.9</b> Point predictions</a></li>
<li class="chapter" data-level="1.2.10" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#comparative-static-predictions"><i class="fa fa-check"></i><b>1.2.10</b> Comparative static predictions</a></li>
<li class="chapter" data-level="1.2.11" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#other-take-aways"><i class="fa fa-check"></i><b>1.2.11</b> Other take-aways</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#risk-and-decision-making"><i class="fa fa-check"></i><b>1.3</b> Risk and decision-making</a><ul>
<li class="chapter" data-level="1.3.1" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#risk-and-uncertainty"><i class="fa fa-check"></i><b>1.3.1</b> Risk and uncertainty</a></li>
<li class="chapter" data-level="1.3.2" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#example-insurance"><i class="fa fa-check"></i><b>1.3.2</b> Example: Insurance</a></li>
<li class="chapter" data-level="1.3.3" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#expected-value"><i class="fa fa-check"></i><b>1.3.3</b> Expected value</a></li>
<li class="chapter" data-level="1.3.4" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#expected-value-1"><i class="fa fa-check"></i><b>1.3.4</b> Expected Value</a></li>
<li class="chapter" data-level="1.3.5" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#but-most-people-care-about-risk"><i class="fa fa-check"></i><b>1.3.5</b> But most people care about risk!</a></li>
<li class="chapter" data-level="1.3.6" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#expected-utility-theory"><i class="fa fa-check"></i><b>1.3.6</b> Expected utility theory</a></li>
<li class="chapter" data-level="1.3.7" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#insurance-with-risk-aversion"><i class="fa fa-check"></i><b>1.3.7</b> Insurance with risk aversion</a></li>
<li class="chapter" data-level="1.3.8" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#insurance-with-risk-aversion---graphically"><i class="fa fa-check"></i><b>1.3.8</b> Insurance with risk aversion - graphically</a></li>
<li class="chapter" data-level="1.3.9" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#insurance-with-risk-aversion-and-deductible"><i class="fa fa-check"></i><b>1.3.9</b> Insurance with risk aversion and deductible</a></li>
<li class="chapter" data-level="1.3.10" data-path="common-content-both-econ-4260-and-econ-6260.html"><a href="common-content-both-econ-4260-and-econ-6260.html#this-one-is-better-solved-numerically"><i class="fa fa-check"></i><b>1.3.10</b> This one is better solved numerically</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="masters-only-content-econ-6260.html"><a href="masters-only-content-econ-6260.html"><i class="fa fa-check"></i><b>2</b> Masters-only content (ECON 6260)</a><ul>
<li class="chapter" data-level="2.1" data-path="masters-only-content-econ-6260.html"><a href="masters-only-content-econ-6260.html#reading-which-is-the-fair-sex"><i class="fa fa-check"></i><b>2.1</b> Reading: Which is the fair sex?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="masters-only-content-econ-6260.html"><a href="masters-only-content-econ-6260.html#plot-the-budget-sets"><i class="fa fa-check"></i><b>2.1.1</b> plot the budget sets</a></li>
<li class="chapter" data-level="2.1.2" data-path="masters-only-content-econ-6260.html"><a href="masters-only-content-econ-6260.html#classification-into-3-types-of-subject"><i class="fa fa-check"></i><b>2.1.2</b> Classification into 3 types of subject</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="problem-sets.html"><a href="problem-sets.html"><i class="fa fa-check"></i><b>3</b> Problem sets</a><ul>
<li class="chapter" data-level="3.1" data-path="problem-sets.html"><a href="problem-sets.html#guessing-game"><i class="fa fa-check"></i><b>3.1</b> Guessing Game</a><ul>
<li class="chapter" data-level="3.1.1" data-path="problem-sets.html"><a href="problem-sets.html#a-description-of-what-happened"><i class="fa fa-check"></i><b>3.1.1</b> A description of what happened</a></li>
<li class="chapter" data-level="3.1.2" data-path="problem-sets.html"><a href="problem-sets.html#your-homework-assignment"><i class="fa fa-check"></i><b>3.1.2</b> Your homework assignment</a></li>
<li class="chapter" data-level="3.1.3" data-path="problem-sets.html"><a href="problem-sets.html#solutions"><i class="fa fa-check"></i><b>3.1.3</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="problem-sets.html"><a href="problem-sets.html#markets-2"><i class="fa fa-check"></i><b>3.2</b> Markets</a><ul>
<li class="chapter" data-level="3.2.1" data-path="problem-sets.html"><a href="problem-sets.html#your-homework-assignment-1"><i class="fa fa-check"></i><b>3.2.1</b> Your homework assignment</a></li>
<li class="chapter" data-level="3.2.2" data-path="problem-sets.html"><a href="problem-sets.html#solutions-1"><i class="fa fa-check"></i><b>3.2.2</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="problem-sets.html"><a href="problem-sets.html#risk"><i class="fa fa-check"></i><b>3.3</b> Risk</a><ul>
<li class="chapter" data-level="3.3.1" data-path="problem-sets.html"><a href="problem-sets.html#questions"><i class="fa fa-check"></i><b>3.3.1</b> Questions</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ECON 4-6260 Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="problem-sets" class="section level1">
<h1><span class="header-section-number">3</span> Problem sets</h1>
<div id="guessing-game" class="section level2">
<h2><span class="header-section-number">3.1</span> Guessing Game</h2>
<p>Information about this game can be found in Chapter 6 of Holt’s <em>Markets, Games, and Strategic Behavior</em>.</p>
<div id="a-description-of-what-happened" class="section level3">
<h3><span class="header-section-number">3.1.1</span> A description of what happened</h3>
<ul>
<li><p>In Part 1, you were asked to choose a number between 0 and 100 (inclusive). A monetary prize was awarded to the person who chose closest to <span class="math inline">\(1/2\)</span> of the average (mean) of your group’s choices. We repeated this task several times.</p></li>
<li><p>In Part 2, you were asked to choose a number between 0 and 100 (inclusive). A monetary prize was awarded to the person who chose closest to 20 plus <span class="math inline">\(1/2\)</span> of the average (mean) of your group’s choices. We repeated this task several times.</p></li>
</ul>
</div>
<div id="your-homework-assignment" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Your homework assignment</h3>
<p>Download the data from the experiment and answer the following questions:</p>
<ol style="list-style-type: decimal">
<li><p>Suppose that you knew for sure that everybody else will choose <span class="math inline">\(x\)</span> (a number between 0 and 100). What should you choose? <em>Show your answer in a plot with <span class="math inline">\(x\)</span> on the horizontal axis, and your choice on the vertical axis.</em> You have just calculated a <em>best response</em>! We will get back to this when we study game theory. Do this for both parts of the experiment.</p></li>
<li><p>There is a number such that if everybody else chooses this <span class="math inline">\(x\)</span>, you want to choose <span class="math inline">\(x\)</span> also. <em>Find this number and explain your working</em>. You can solve this either analytically (i.e. pen paper) or computationally (e.g. with <em>Excel</em>, <em>R</em>, <em>Stata</em>, etc). The explanation is the important part.</p></li>
<li><p>Based on your answer to part (2), what would Nash equilibrium predict if we increased the group size?</p></li>
<li><p>Create a plot showing the average choice on the vertical axis, and the round number on the horizontal axis. Show the Nash equilibrium predictions on this plot.</p></li>
<li><p>Compare your theoretical predictions (i.e. questions 1 &amp; 2) to the plot in question (4). What do you think is going on?</p></li>
<li><p>(6260 students only): Test whether or not the means between the two parts are different. State your assumptions. Comment on how appropriate they are.</p></li>
</ol>
</div>
<div id="solutions" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Solutions</h3>
<div id="best-response" class="section level4">
<h4><span class="header-section-number">3.1.3.1</span> 1 - Best response</h4>
<p>If I choose <span class="math inline">\(y\)</span> and everyone else chooses <span class="math inline">\(x\)</span>, then the average is:
<span class="math display">\[
\frac{\text{my choice}+(n-1)(\text{others&#39; choices})}{n}=\frac{y+(n-1)x}{n}
\]</span>
In Part 1, we want to choose a <span class="math inline">\(y\)</span> that is equal to <span class="math inline">\(1/2\)</span> of this number, so this sets up the equation:
<span class="math display">\[
\begin{aligned}
y^*=\frac12\frac{y^*+(n-1)x}{n}
\end{aligned}
\]</span>
Note that <span class="math inline">\(y*\)</span> is on the left- and right-hand side, so we need to solve for <span class="math inline">\(y^*\)</span>:
<span class="math display">\[
\begin{aligned}
2ny^*&amp;=y^*+(n-1)x\\
y^*(2n-1)&amp;=(n-1)x\\
y^*&amp;=\frac{(n-1)x}{2n-1}
\end{aligned}
\]</span>
Note that for any group, <span class="math inline">\(n\geq2\)</span>, so we are not dividing by zero.</p>
<p>For Part 2, we need to choose as close as possible to 20 plus half the average. In math, we want to solve:
<span class="math display">\[
\begin{aligned}
y^*&amp;=20+\frac12\frac{y^*+(n-1)x}{n}\\
2ny^*&amp;=40n+y^*+(n-1)x\\
y^*(2n-1)&amp;=40n+(n-1)x\\
y^*&amp;=\frac{40n+(n-1)x}{2n-1}
\end{aligned}
\]</span></p>
<p>So getting these into plots</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="problem-sets.html#cb12-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb12-2"><a href="problem-sets.html#cb12-2"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb12-3"><a href="problem-sets.html#cb12-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb12-4"><a href="problem-sets.html#cb12-4"></a></span>
<span id="cb12-5"><a href="problem-sets.html#cb12-5"></a>x&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb12-6"><a href="problem-sets.html#cb12-6"></a>n&lt;-<span class="dv">4</span></span>
<span id="cb12-7"><a href="problem-sets.html#cb12-7"></a>y&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>x<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n<span class="dv">-1</span>)</span>
<span id="cb12-8"><a href="problem-sets.html#cb12-8"></a>PlotThis&lt;-<span class="kw">data.frame</span>(x,y)</span>
<span id="cb12-9"><a href="problem-sets.html#cb12-9"></a>PlotThis<span class="op">$</span>Part&lt;-<span class="st">&quot;1&quot;</span></span>
<span id="cb12-10"><a href="problem-sets.html#cb12-10"></a>tmp&lt;-PlotThis</span>
<span id="cb12-11"><a href="problem-sets.html#cb12-11"></a>tmp<span class="op">$</span>y&lt;-(<span class="dv">40</span><span class="op">*</span>n<span class="op">+</span>(n<span class="dv">-1</span>)<span class="op">*</span>x)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n<span class="dv">-1</span>)</span>
<span id="cb12-12"><a href="problem-sets.html#cb12-12"></a>tmp<span class="op">$</span>Part&lt;-<span class="st">&quot;2&quot;</span></span>
<span id="cb12-13"><a href="problem-sets.html#cb12-13"></a></span>
<span id="cb12-14"><a href="problem-sets.html#cb12-14"></a>PlotThis&lt;-<span class="kw">rbind</span>(PlotThis,tmp)</span>
<span id="cb12-15"><a href="problem-sets.html#cb12-15"></a>plt1&lt;-(<span class="kw">ggplot</span>(PlotThis,<span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">linetype=</span>Part))</span>
<span id="cb12-16"><a href="problem-sets.html#cb12-16"></a>  <span class="op">+</span><span class="kw">geom_line</span>()</span>
<span id="cb12-17"><a href="problem-sets.html#cb12-17"></a>  <span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb12-18"><a href="problem-sets.html#cb12-18"></a>  <span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Others&#39; choice&quot;</span>)</span>
<span id="cb12-19"><a href="problem-sets.html#cb12-19"></a>  <span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Best response&quot;</span>)</span>
<span id="cb12-20"><a href="problem-sets.html#cb12-20"></a>)</span>
<span id="cb12-21"><a href="problem-sets.html#cb12-21"></a>plt1</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="nash-equilibrium" class="section level4">
<h4><span class="header-section-number">3.1.3.2</span> 2 - Nash equilibrium</h4>
<p>In both parts, we are looking for a solution for <span class="math inline">\(y^*=x\)</span>. That is, if everyone else is choosing <span class="math inline">\(x\)</span>, I also want to choose <span class="math inline">\(x\)</span>.</p>
<p>For Part 1, this sets up the equation:
<span class="math display">\[
x=\frac{(n-1)x}{2n-1}
\]</span>
so <span class="math inline">\(x=0\)</span> is the Nash equilibrium of this game.</p>
<p>For Part 2, we have:
<span class="math display">\[
\begin{aligned}
x&amp;=\frac{40n+(n-1)x}{2n-1}\\
x(2n-1)&amp;=40n+(n-1)x\\
x\left((2n-1)-(n-1)\right)&amp;=40n\\
nx&amp;=40n\\
x=40
\end{aligned}
\]</span>
Graphically, we are looking for an intersection of our best response curves with the <span class="math inline">\(45^\circ\)</span> line, (i.e. <span class="math inline">\(x=y\)</span>):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="problem-sets.html#cb13-1"></a>plt2&lt;-(plt1</span>
<span id="cb13-2"><a href="problem-sets.html#cb13-2"></a>       <span class="op">+</span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">1</span>,<span class="dt">intercept=</span><span class="dv">0</span>,<span class="dt">color=</span><span class="st">&quot;red&quot;</span>))</span>
<span id="cb13-3"><a href="problem-sets.html#cb13-3"></a>plt2</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
<div id="group-size" class="section level4">
<h4><span class="header-section-number">3.1.3.3</span> 3 - Group size</h4>
<p><span class="math inline">\(n\)</span> does not appear in the Nash equilibrium prediction, so Nash predicts that <em>nothing will change</em> if we increase the group size.</p>
</div>
<div id="data" class="section level4">
<h4><span class="header-section-number">3.1.3.4</span> 4 - Data</h4>
<p>This plot is overkill, I’m not expecrting you to have something with box plots and loess smoothing. You can see the data’s means in the middle lines of the box plots.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="problem-sets.html#cb14-1"></a><span class="kw">library</span>(readxl)</span>
<span id="cb14-2"><a href="problem-sets.html#cb14-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb14-3"><a href="problem-sets.html#cb14-3"></a>T1&lt;-<span class="kw">data.frame</span>(<span class="kw">read_excel</span>(<span class="st">&quot;PS01-GuessingGame.xlsx&quot;</span>,<span class="dt">sheet=</span><span class="st">&quot;Treatment1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;Round&quot;</span>,<span class="st">&quot;Guess&quot;</span>))</span>
<span id="cb14-4"><a href="problem-sets.html#cb14-4"></a>T2&lt;-<span class="kw">data.frame</span>(<span class="kw">read_excel</span>(<span class="st">&quot;PS01-GuessingGame.xlsx&quot;</span>,<span class="dt">sheet=</span><span class="st">&quot;Treatment 2&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="st">&quot;Round&quot;</span>,<span class="st">&quot;Guess&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Round=</span>Round<span class="op">+</span><span class="dv">10</span>) </span>
<span id="cb14-5"><a href="problem-sets.html#cb14-5"></a></span>
<span id="cb14-6"><a href="problem-sets.html#cb14-6"></a>T1<span class="op">$</span>Part &lt;-<span class="dv">1</span></span>
<span id="cb14-7"><a href="problem-sets.html#cb14-7"></a>T2<span class="op">$</span>Part&lt;-<span class="dv">2</span></span>
<span id="cb14-8"><a href="problem-sets.html#cb14-8"></a></span>
<span id="cb14-9"><a href="problem-sets.html#cb14-9"></a>D&lt;-<span class="kw">rbind</span>(T1,T2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb14-10"><a href="problem-sets.html#cb14-10"></a>                      <span class="dt">Round=</span><span class="kw">as.factor</span>(Round),</span>
<span id="cb14-11"><a href="problem-sets.html#cb14-11"></a>                      <span class="dt">Guess=</span><span class="kw">as.numeric</span>(Guess)</span>
<span id="cb14-12"><a href="problem-sets.html#cb14-12"></a>                      </span>
<span id="cb14-13"><a href="problem-sets.html#cb14-13"></a>  )</span>
<span id="cb14-14"><a href="problem-sets.html#cb14-14"></a></span>
<span id="cb14-15"><a href="problem-sets.html#cb14-15"></a></span>
<span id="cb14-16"><a href="problem-sets.html#cb14-16"></a>Round&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>)</span>
<span id="cb14-17"><a href="problem-sets.html#cb14-17"></a>Part&lt;-<span class="kw">paste</span>(<span class="dv">1</span><span class="op">+</span>(Round<span class="op">&gt;=</span><span class="dv">6</span>))</span>
<span id="cb14-18"><a href="problem-sets.html#cb14-18"></a>MeanChoice&lt;-<span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">30</span>,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">48</span>,<span class="dv">40</span>)</span>
<span id="cb14-19"><a href="problem-sets.html#cb14-19"></a>Nash&lt;-(Round<span class="op">&gt;=</span><span class="dv">6</span>)<span class="op">*</span><span class="dv">40</span></span>
<span id="cb14-20"><a href="problem-sets.html#cb14-20"></a></span>
<span id="cb14-21"><a href="problem-sets.html#cb14-21"></a>plt3&lt;-(</span>
<span id="cb14-22"><a href="problem-sets.html#cb14-22"></a>  <span class="kw">ggplot</span>(D,<span class="kw">aes</span>(<span class="dt">x=</span>Round,<span class="dt">y=</span>Guess))</span>
<span id="cb14-23"><a href="problem-sets.html#cb14-23"></a>  <span class="op">+</span><span class="kw">geom_smooth</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x, <span class="dt">method=</span><span class="st">&quot;loess&quot;</span>,<span class="kw">aes</span>(<span class="dt">group=</span>Part,<span class="dt">color=</span><span class="st">&quot;Data&quot;</span>))</span>
<span id="cb14-24"><a href="problem-sets.html#cb14-24"></a>  <span class="op">+</span><span class="kw">geom_boxplot</span>(<span class="dt">alpha=</span><span class="fl">0.7</span>,<span class="kw">aes</span>(<span class="dt">color=</span><span class="st">&quot;Data&quot;</span>))</span>
<span id="cb14-25"><a href="problem-sets.html#cb14-25"></a>  <span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb14-26"><a href="problem-sets.html#cb14-26"></a>  <span class="op">+</span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="fl">10.5</span>,<span class="dt">color=</span><span class="st">&quot;black&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb14-27"><a href="problem-sets.html#cb14-27"></a>  <span class="op">+</span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">1</span>,<span class="dt">y=</span><span class="dv">0</span>,<span class="dt">xend=</span><span class="dv">10</span>,<span class="dt">yend=</span><span class="dv">0</span>,<span class="dt">color=</span><span class="st">&quot;Nash&quot;</span>),<span class="dt">size=</span><span class="dv">2</span>)</span>
<span id="cb14-28"><a href="problem-sets.html#cb14-28"></a>  <span class="op">+</span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">11</span>,<span class="dt">y=</span><span class="dv">40</span>,<span class="dt">xend=</span><span class="dv">15</span>,<span class="dt">yend=</span><span class="dv">40</span>,<span class="dt">color=</span><span class="st">&quot;Nash&quot;</span>),<span class="dt">size=</span><span class="dv">2</span>)</span>
<span id="cb14-29"><a href="problem-sets.html#cb14-29"></a>  <span class="op">+</span><span class="kw">theme</span>(<span class="dt">legend.title=</span><span class="kw">element_blank</span>())</span>
<span id="cb14-30"><a href="problem-sets.html#cb14-30"></a>)</span>
<span id="cb14-31"><a href="problem-sets.html#cb14-31"></a>plt3</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="comparison" class="section level4">
<h4><span class="header-section-number">3.1.3.5</span> 5 - Comparison</h4>
<p>In both parts, choices seem to be trending in the direction of the Nash equilibrium. Especially in the first part, there is a large gap in the early rounds between the prediction and choices.</p>
</div>
<div id="statistical-test-6260-students-only" class="section level4">
<h4><span class="header-section-number">3.1.3.6</span> 6 - Statistical test (6260 students only)</h4>
<p>Here I will use linear regression.</p>
<table style="text-align:center">
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
Guess
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Part == 2
</td>
<td>
17.043<sup>***</sup>
</td>
<td>
17.043<sup>***</sup>
</td>
<td>
26.156<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(3.017)
</td>
<td>
(2.331)
</td>
<td>
(3.595)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Trend1
</td>
<td>
</td>
<td>
</td>
<td>
22.956<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
(7.273)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Trend2
</td>
<td>
</td>
<td>
</td>
<td>
-4.652
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
(5.771)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
17.392<sup>***</sup>
</td>
<td>
17.392<sup>***</sup>
</td>
<td>
10.404<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1.738)
</td>
<td>
(2.054)
</td>
<td>
(2.924)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
196
</td>
<td>
196
</td>
<td>
196
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.141
</td>
<td>
0.141
</td>
<td>
0.198
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.137
</td>
<td>
0.137
</td>
<td>
0.186
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
19.888 (df = 194)
</td>
<td>
19.888 (df = 194)
</td>
<td>
19.318 (df = 192)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
31.904<sup>***</sup> (df = 1; 194)
</td>
<td>
31.904<sup>***</sup> (df = 1; 194)
</td>
<td>
15.807<sup>***</sup> (df = 3; 192)
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="3" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>The specification I use in column 1 is equivalent to the 2-sample <span class="math inline">\(t\)</span>-test with different variances. Column 2 is the same as column 1 except using heteroskedasticity-robust standard errors. Column 3 adds in some “early round” effects. I.e. <span class="math inline">\(\text{Trend1}=1/\text{Round}\)</span>, which approaches zero as many rounds are played. In all regressions, the coefficient of interest is “Part==2”, which is the estimate of the difference in means between the second and first part (after time trends become negligible in column (3)). Note that adding this to the constant gets the regression’s prediction for Part 2, which is about 35 (not too far away from Nash). In all cases we reject the null hypothesis (both one and two-sided, at all sane levels of significance) that the two parts have equal means.</p>
<p>The assumptions required for Column (2) are:</p>
<ul>
<li>The error term is uncorrelated with Part. This is plausible because Part was a variable chosen by the experimenter (i.e. it is exogenous)</li>
<li>The error term is independent. This is almost certainly wrong:
<ul>
<li>It is likely that a participant’s errors are correlated, which could be fixed with clustering at the participant level (we can’t do this because we can’t link IDs across each part)</li>
<li>It is likely that errors are correlated within groups playing together. We can’t account for this because we only had one group in the 2nd part.</li>
</ul></li>
<li>The variance of the error term in the regression is finite.</li>
</ul>
</div>
</div>
</div>
<div id="markets-2" class="section level2">
<h2><span class="header-section-number">3.2</span> Markets</h2>
<div id="your-homework-assignment-1" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Your homework assignment</h3>
<ol style="list-style-type: decimal">
<li><p>What could have happened in the market between Parts 1 and 2? Tell me one thing the government could have done to make this change, and one thing that could have happened not involving the market.</p></li>
<li><p>Draw the supply and demand curves for both parts of the experiment. Label equilibrium price and quantity</p></li>
<li><p>On a separate plot, show every trade price for every round. Include your predicted prices from Part 1.
(this is a deliberately vague question, I am asking you to think about how to communicate the results of this experiment graphically)</p></li>
<li><p>Compute the predicted producer, consumer, and total surplus in both parts. Compare these to the actual consumer, producer, and total surplus from the experiment (dividing this up by round).</p></li>
<li><p>Write a short paragraph telling me your main findings. When needed, make reference to the three plots you made.</p></li>
<li><p>(6260 students only) The model also makes predictions about how many items each seller will sell, and how many items each buyer will buy. Comment on how well the theory is predicting these individual-level quantities (Again, this is another deliberately vague question. I am looking to see how you approach this problem)</p></li>
</ol>
</div>
<div id="solutions-1" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Solutions</h3>
<div id="loading-the-data" class="section level4">
<h4><span class="header-section-number">3.2.2.1</span> Loading the data</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="problem-sets.html#cb15-1"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb15-2"><a href="problem-sets.html#cb15-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb15-3"><a href="problem-sets.html#cb15-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb15-4"><a href="problem-sets.html#cb15-4"></a>DRaw&lt;-<span class="kw">data.frame</span>(<span class="kw">read.csv</span>(<span class="st">&quot;PS02data.csv&quot;</span>))</span>
<span id="cb15-5"><a href="problem-sets.html#cb15-5"></a>D&lt;-(DRaw</span>
<span id="cb15-6"><a href="problem-sets.html#cb15-6"></a>    <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_all</span>(<span class="dt">.funs =</span>as.numeric)</span>
<span id="cb15-7"><a href="problem-sets.html#cb15-7"></a>    <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Part =</span> <span class="dv">1</span><span class="op">+</span>(Round<span class="op">&gt;=</span><span class="dv">6</span>))</span>
<span id="cb15-8"><a href="problem-sets.html#cb15-8"></a>)</span>
<span id="cb15-9"><a href="problem-sets.html#cb15-9"></a>D<span class="op">$</span>Status&lt;-<span class="kw">as.factor</span>(DRaw<span class="op">$</span>Status)</span>
<span id="cb15-10"><a href="problem-sets.html#cb15-10"></a>D<span class="op">$</span>Role&lt;-<span class="st">&quot;Buyer&quot;</span></span>
<span id="cb15-11"><a href="problem-sets.html#cb15-11"></a>D<span class="op">$</span>Role[<span class="kw">is.na</span>(D<span class="op">$</span>Value)]&lt;-<span class="st">&quot;Seller&quot;</span></span>
<span id="cb15-12"><a href="problem-sets.html#cb15-12"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(D))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="6%" />
<col width="5%" />
<col width="2%" />
<col width="4%" />
<col width="5%" />
<col width="3%" />
<col width="4%" />
<col width="3%" />
<col width="6%" />
<col width="12%" />
<col width="8%" />
<col width="19%" />
<col width="4%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="right">Record</th>
<th align="right">Round</th>
<th align="right">ID</th>
<th align="right">Unit</th>
<th align="right">Value</th>
<th align="right">Bid</th>
<th align="right">Cost</th>
<th align="right">Ask</th>
<th align="left">Status</th>
<th align="right">Market_Price</th>
<th align="right">Earnings</th>
<th align="right">Cumulative_earnings</th>
<th align="right">Part</th>
<th align="left">Role</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">32</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">33</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">34</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">i</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="left">Buyer</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="problem-sets.html#cb16-1"></a>Parameters&lt;-<span class="kw">data.frame</span>(<span class="kw">read.csv</span>(<span class="st">&quot;PS02Parameters.csv&quot;</span>))</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>What could have happened in the market between Parts 1 and 2? Tell me one thing the government could have done to make this change, and one thing that could have happened not involving the market.</p></li>
<li><p>Draw the supply and demand curves for both parts of the experiment. Label equilibrium price and quantity</p></li>
</ol>
<p><strong>Solution</strong>: Here I will do questions 1 &amp; 2 together, as it helps to have the supply and demand diagram to work out what happened.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="problem-sets.html#cb17-1"></a><span class="co"># extract values and costs from rounds 1 and 6</span></span>
<span id="cb17-2"><a href="problem-sets.html#cb17-2"></a></span>
<span id="cb17-3"><a href="problem-sets.html#cb17-3"></a>SupplyDemand&lt;-<span class="kw">data.frame</span>()</span>
<span id="cb17-4"><a href="problem-sets.html#cb17-4"></a>EQ&lt;-<span class="kw">data.frame</span>()</span>
<span id="cb17-5"><a href="problem-sets.html#cb17-5"></a>P&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(Parameters<span class="op">$</span>v, <span class="dt">na.rm=</span>T)<span class="op">+</span><span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb17-6"><a href="problem-sets.html#cb17-6"></a></span>
<span id="cb17-7"><a href="problem-sets.html#cb17-7"></a><span class="cf">for</span> (rr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) { </span>
<span id="cb17-8"><a href="problem-sets.html#cb17-8"></a>  </span>
<span id="cb17-9"><a href="problem-sets.html#cb17-9"></a>  <span class="co"># supply and demand functions</span></span>
<span id="cb17-10"><a href="problem-sets.html#cb17-10"></a>  Qd&lt;-<span class="cf">function</span>(p,r) {</span>
<span id="cb17-11"><a href="problem-sets.html#cb17-11"></a>    v&lt;-Parameters <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Part<span class="op">==</span>r) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(v) </span>
<span id="cb17-12"><a href="problem-sets.html#cb17-12"></a>    <span class="kw">sum</span>(v<span class="op">&gt;=</span>p,<span class="dt">na.rm=</span>T)</span>
<span id="cb17-13"><a href="problem-sets.html#cb17-13"></a>  }</span>
<span id="cb17-14"><a href="problem-sets.html#cb17-14"></a>  Qs&lt;-<span class="cf">function</span>(p,r) {</span>
<span id="cb17-15"><a href="problem-sets.html#cb17-15"></a>    c&lt;-Parameters  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Part<span class="op">==</span>r) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(c)</span>
<span id="cb17-16"><a href="problem-sets.html#cb17-16"></a>    <span class="kw">sum</span>(c<span class="op">&lt;=</span>p,<span class="dt">na.rm=</span>T)</span>
<span id="cb17-17"><a href="problem-sets.html#cb17-17"></a>  }</span>
<span id="cb17-18"><a href="problem-sets.html#cb17-18"></a>  </span>
<span id="cb17-19"><a href="problem-sets.html#cb17-19"></a></span>
<span id="cb17-20"><a href="problem-sets.html#cb17-20"></a>  Q&lt;-<span class="kw">apply</span>(<span class="kw">as.matrix</span>(P),<span class="dv">1</span>,<span class="dt">FUN =</span> {<span class="cf">function</span>(p) <span class="kw">Qs</span>(p,rr)})</span>
<span id="cb17-21"><a href="problem-sets.html#cb17-21"></a>  tmp&lt;-<span class="kw">data.frame</span>(P,Q)</span>
<span id="cb17-22"><a href="problem-sets.html#cb17-22"></a>  tmp<span class="op">$</span>type=<span class="st">&quot;Supply&quot;</span></span>
<span id="cb17-23"><a href="problem-sets.html#cb17-23"></a>  tmp<span class="op">$</span>Part =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Part&quot;</span>,rr)</span>
<span id="cb17-24"><a href="problem-sets.html#cb17-24"></a>  SupplyDemand&lt;-<span class="kw">rbind</span>(SupplyDemand,tmp)</span>
<span id="cb17-25"><a href="problem-sets.html#cb17-25"></a>  </span>
<span id="cb17-26"><a href="problem-sets.html#cb17-26"></a>  ExcessDemand&lt;-Q</span>
<span id="cb17-27"><a href="problem-sets.html#cb17-27"></a>  </span>
<span id="cb17-28"><a href="problem-sets.html#cb17-28"></a>  </span>
<span id="cb17-29"><a href="problem-sets.html#cb17-29"></a>  Q&lt;-<span class="kw">apply</span>(<span class="kw">as.matrix</span>(P),<span class="dv">1</span>,<span class="dt">FUN =</span> {<span class="cf">function</span>(p) <span class="kw">Qd</span>(p,rr)})</span>
<span id="cb17-30"><a href="problem-sets.html#cb17-30"></a>  tmp&lt;-<span class="kw">data.frame</span>(P,Q)</span>
<span id="cb17-31"><a href="problem-sets.html#cb17-31"></a>  tmp<span class="op">$</span>type=<span class="st">&quot;Demand&quot;</span></span>
<span id="cb17-32"><a href="problem-sets.html#cb17-32"></a>  tmp<span class="op">$</span>Part =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Part&quot;</span>,rr)</span>
<span id="cb17-33"><a href="problem-sets.html#cb17-33"></a>  SupplyDemand&lt;-<span class="kw">rbind</span>(SupplyDemand,tmp)</span>
<span id="cb17-34"><a href="problem-sets.html#cb17-34"></a>  </span>
<span id="cb17-35"><a href="problem-sets.html#cb17-35"></a>  ExcessDemand&lt;-<span class="st"> </span><span class="op">-</span>(ExcessDemand<span class="op">-</span>Q)</span>
<span id="cb17-36"><a href="problem-sets.html#cb17-36"></a>  </span>
<span id="cb17-37"><a href="problem-sets.html#cb17-37"></a>  ii&lt;-<span class="kw">sum</span>(<span class="dv">1</span><span class="op">*!</span>(ExcessDemand<span class="op">&lt;=</span><span class="dv">0</span>))</span>
<span id="cb17-38"><a href="problem-sets.html#cb17-38"></a>  Peq&lt;-<span class="kw">round</span>(P[ii]) <span class="co"># I know there is an integer solution</span></span>
<span id="cb17-39"><a href="problem-sets.html#cb17-39"></a>  Qeq&lt;-Q[ii]</span>
<span id="cb17-40"><a href="problem-sets.html#cb17-40"></a>  </span>
<span id="cb17-41"><a href="problem-sets.html#cb17-41"></a>  tmp&lt;-<span class="kw">data.frame</span>(Peq,Qeq)</span>
<span id="cb17-42"><a href="problem-sets.html#cb17-42"></a>  tmp<span class="op">$</span>Part&lt;-<span class="kw">paste</span>(<span class="st">&quot;Part&quot;</span>,rr)</span>
<span id="cb17-43"><a href="problem-sets.html#cb17-43"></a>  EQ&lt;-<span class="kw">rbind</span>(EQ,tmp) </span>
<span id="cb17-44"><a href="problem-sets.html#cb17-44"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="problem-sets.html#cb18-1"></a><span class="kw">print</span>(EQ)</span></code></pre></div>
<pre><code>##   Peq Qeq   Part
## 1   5  20 Part 1
## 2   6  16 Part 2</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="problem-sets.html#cb20-1"></a>EQ<span class="op">$</span>type&lt;-<span class="st">&quot;Equilibrium&quot;</span></span>
<span id="cb20-2"><a href="problem-sets.html#cb20-2"></a></span>
<span id="cb20-3"><a href="problem-sets.html#cb20-3"></a>plt&lt;-(</span>
<span id="cb20-4"><a href="problem-sets.html#cb20-4"></a>  <span class="kw">ggplot</span>(SupplyDemand,<span class="kw">aes</span>(<span class="dt">x=</span>Q,<span class="dt">y=</span>P,<span class="dt">color=</span>type,<span class="dt">group=</span><span class="kw">paste</span>(type,Part),<span class="dt">linetype=</span>Part))</span>
<span id="cb20-5"><a href="problem-sets.html#cb20-5"></a>  <span class="op">+</span><span class="kw">geom_path</span>(<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">alpha=</span><span class="fl">0.8</span>)</span>
<span id="cb20-6"><a href="problem-sets.html#cb20-6"></a>  <span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb20-7"><a href="problem-sets.html#cb20-7"></a>  <span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Quantity&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Price ($)&quot;</span>)</span>
<span id="cb20-8"><a href="problem-sets.html#cb20-8"></a>  <span class="op">+</span><span class="kw">geom_vline</span>(<span class="dt">data=</span>EQ,<span class="kw">aes</span>(<span class="dt">xintercept=</span>Qeq),<span class="dt">color=</span><span class="st">&quot;black&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb20-9"><a href="problem-sets.html#cb20-9"></a>  <span class="op">+</span><span class="kw">geom_hline</span>(<span class="dt">data=</span>EQ,<span class="kw">aes</span>(<span class="dt">yintercept=</span>Peq),<span class="dt">color=</span><span class="st">&quot;black&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb20-10"><a href="problem-sets.html#cb20-10"></a>  <span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">data=</span>EQ,<span class="kw">aes</span>(<span class="dt">x=</span>Qeq,<span class="dt">y=</span>Peq),<span class="dt">size=</span><span class="dv">4</span>)</span>
<span id="cb20-11"><a href="problem-sets.html#cb20-11"></a>  <span class="co">#+theme(legend.position=&quot;none&quot;)</span></span>
<span id="cb20-12"><a href="problem-sets.html#cb20-12"></a>)</span>
<span id="cb20-13"><a href="problem-sets.html#cb20-13"></a><span class="kw">print</span>(plt)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>From the above Figure, we can see that supply has shifted to the left (or up, by $2). Two possible causes of this could be:</p>
<ul>
<li>The government imposes a $2 tax on sellers</li>
<li>An input cost increases</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>On a separate plot, show every trade price for every round. Include your predicted prices from Part 1.
(this is a deliberately vague question, I am asking you to think about how to communicate the results of this experiment graphically)</li>
</ol>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="problem-sets.html#cb21-1"></a><span class="kw">library</span>(latex2exp)</span>
<span id="cb21-2"><a href="problem-sets.html#cb21-2"></a>NewRound&lt;-<span class="kw">c</span>()</span>
<span id="cb21-3"><a href="problem-sets.html#cb21-3"></a><span class="cf">for</span> (rr <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</span>
<span id="cb21-4"><a href="problem-sets.html#cb21-4"></a>  NewRound[rr]&lt;-<span class="st"> </span><span class="kw">max</span>((D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Round<span class="op">==</span>rr ))<span class="op">$</span>Record)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb21-5"><a href="problem-sets.html#cb21-5"></a>}</span>
<span id="cb21-6"><a href="problem-sets.html#cb21-6"></a></span>
<span id="cb21-7"><a href="problem-sets.html#cb21-7"></a>Summary&lt;-(D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Record<span class="op">&gt;=</span><span class="dv">450</span> <span class="op">&amp;</span><span class="st"> </span>Status<span class="op">==</span><span class="st">&quot;t&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Round)</span>
<span id="cb21-8"><a href="problem-sets.html#cb21-8"></a>                <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">summarize</span>(</span>
<span id="cb21-9"><a href="problem-sets.html#cb21-9"></a>                      <span class="dt">m=</span><span class="kw">mean</span>(Bid,<span class="dt">na.rm=</span>T),</span>
<span id="cb21-10"><a href="problem-sets.html#cb21-10"></a>                      <span class="dt">s=</span><span class="kw">sd</span>(Bid,<span class="dt">na.rm=</span>T))</span>
<span id="cb21-11"><a href="problem-sets.html#cb21-11"></a>)</span>
<span id="cb21-12"><a href="problem-sets.html#cb21-12"></a></span>
<span id="cb21-13"><a href="problem-sets.html#cb21-13"></a>D &lt;-<span class="st"> </span>D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(Summary,<span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;Round&quot;</span>))</span>
<span id="cb21-14"><a href="problem-sets.html#cb21-14"></a></span>
<span id="cb21-15"><a href="problem-sets.html#cb21-15"></a>(</span>
<span id="cb21-16"><a href="problem-sets.html#cb21-16"></a>  <span class="kw">ggplot</span>(D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Status<span class="op">==</span><span class="st">&quot;t&quot;</span>),<span class="kw">aes</span>(<span class="dt">x=</span>Record))</span>
<span id="cb21-17"><a href="problem-sets.html#cb21-17"></a>  <span class="op">+</span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y=</span>Bid,<span class="dt">color=</span><span class="st">&quot;data&quot;</span>))</span>
<span id="cb21-18"><a href="problem-sets.html#cb21-18"></a>  <span class="co">#+geom_line(aes(y=Bid,color=&quot;data&quot;))</span></span>
<span id="cb21-19"><a href="problem-sets.html#cb21-19"></a>  <span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb21-20"><a href="problem-sets.html#cb21-20"></a>  <span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Record,<span class="dt">y=</span>m,<span class="dt">group=</span>Round,<span class="dt">color=</span><span class="st">&quot;mean&quot;</span>))</span>
<span id="cb21-21"><a href="problem-sets.html#cb21-21"></a>  <span class="op">+</span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Record,<span class="dt">ymax=</span>(m<span class="op">+</span>s),<span class="dt">ymin=</span>(m<span class="op">-</span>s),<span class="dt">fill=</span><span class="st">&quot;\U00B1 1 sd&quot;</span>),<span class="dt">alpha=</span><span class="fl">0.1</span>)</span>
<span id="cb21-22"><a href="problem-sets.html#cb21-22"></a>  <span class="op">+</span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span>NewRound)</span>
<span id="cb21-23"><a href="problem-sets.html#cb21-23"></a>  <span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">11</span>))</span>
<span id="cb21-24"><a href="problem-sets.html#cb21-24"></a>  <span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Record,<span class="dt">y=</span>EQ<span class="op">$</span>Peq[Part],<span class="dt">group=</span>Part,<span class="dt">color=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb21-25"><a href="problem-sets.html#cb21-25"></a>  <span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Traded price ($)&quot;</span>)</span>
<span id="cb21-26"><a href="problem-sets.html#cb21-26"></a>  <span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Record number&quot;</span>)</span>
<span id="cb21-27"><a href="problem-sets.html#cb21-27"></a>  <span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">10</span>))<span class="op">+</span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">500</span>,<span class="dv">1100</span>))</span>
<span id="cb21-28"><a href="problem-sets.html#cb21-28"></a>  </span>
<span id="cb21-29"><a href="problem-sets.html#cb21-29"></a>  </span>
<span id="cb21-30"><a href="problem-sets.html#cb21-30"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Compute the predicted producer, consumer, and total surplus in both parts. Compare these to the actual consumer, producer, and total surplus from the experiment (dividing this up by round).</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="problem-sets.html#cb22-1"></a><span class="co"># Surplus for each part</span></span>
<span id="cb22-2"><a href="problem-sets.html#cb22-2"></a>Parameters&lt;-(Parameters</span>
<span id="cb22-3"><a href="problem-sets.html#cb22-3"></a>             <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">EQ_CS =</span> v<span class="op">-</span>EQ<span class="op">$</span>Peq[Part],</span>
<span id="cb22-4"><a href="problem-sets.html#cb22-4"></a>                        <span class="dt">EQ_PS =</span> EQ<span class="op">$</span>Peq[Part]<span class="op">-</span>c)</span>
<span id="cb22-5"><a href="problem-sets.html#cb22-5"></a>                            </span>
<span id="cb22-6"><a href="problem-sets.html#cb22-6"></a>             <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">EQ_CS =</span> EQ_CS<span class="op">*</span>(EQ_CS<span class="op">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb22-7"><a href="problem-sets.html#cb22-7"></a>                        <span class="dt">EQ_PS =</span> EQ_PS<span class="op">*</span>(EQ_PS<span class="op">&gt;=</span><span class="dv">0</span>)</span>
<span id="cb22-8"><a href="problem-sets.html#cb22-8"></a>                        )</span>
<span id="cb22-9"><a href="problem-sets.html#cb22-9"></a>             </span>
<span id="cb22-10"><a href="problem-sets.html#cb22-10"></a>  </span>
<span id="cb22-11"><a href="problem-sets.html#cb22-11"></a>)</span>
<span id="cb22-12"><a href="problem-sets.html#cb22-12"></a></span>
<span id="cb22-13"><a href="problem-sets.html#cb22-13"></a>Surplus&lt;-(</span>
<span id="cb22-14"><a href="problem-sets.html#cb22-14"></a>  Parameters </span>
<span id="cb22-15"><a href="problem-sets.html#cb22-15"></a>  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Part) </span>
<span id="cb22-16"><a href="problem-sets.html#cb22-16"></a>  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">CS =</span> <span class="kw">sum</span>(EQ_CS,<span class="dt">na.rm=</span>T),<span class="dt">PS =</span> <span class="kw">sum</span>(EQ_PS,<span class="dt">na.rm=</span>T)) </span>
<span id="cb22-17"><a href="problem-sets.html#cb22-17"></a>  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">TS =</span> CS<span class="op">+</span>PS)</span>
<span id="cb22-18"><a href="problem-sets.html#cb22-18"></a>    </span>
<span id="cb22-19"><a href="problem-sets.html#cb22-19"></a>  </span>
<span id="cb22-20"><a href="problem-sets.html#cb22-20"></a>)</span>
<span id="cb22-21"><a href="problem-sets.html#cb22-21"></a></span>
<span id="cb22-22"><a href="problem-sets.html#cb22-22"></a>knitr<span class="op">::</span><span class="kw">kable</span>(Surplus)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Part</th>
<th align="right">CS</th>
<th align="right">PS</th>
<th align="right">TS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">42</td>
<td align="right">42</td>
<td align="right">84</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">26</td>
<td align="right">24</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="problem-sets.html#cb23-1"></a>D &lt;-<span class="st"> </span>(D</span>
<span id="cb23-2"><a href="problem-sets.html#cb23-2"></a>      <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Status<span class="op">==</span><span class="st">&quot;t&quot;</span>)</span>
<span id="cb23-3"><a href="problem-sets.html#cb23-3"></a>      <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Round)</span>
<span id="cb23-4"><a href="problem-sets.html#cb23-4"></a>      <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">CumlativeSurplus =</span> <span class="kw">cumsum</span>(Earnings))</span>
<span id="cb23-5"><a href="problem-sets.html#cb23-5"></a>)</span>
<span id="cb23-6"><a href="problem-sets.html#cb23-6"></a></span>
<span id="cb23-7"><a href="problem-sets.html#cb23-7"></a>(<span class="kw">ggplot</span>(D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Status<span class="op">==</span><span class="st">&quot;t&quot;</span>))</span>
<span id="cb23-8"><a href="problem-sets.html#cb23-8"></a>        <span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Record,<span class="dt">y=</span>CumlativeSurplus,<span class="dt">group=</span>Round,<span class="dt">color=</span><span class="st">&quot;Data&quot;</span>))</span>
<span id="cb23-9"><a href="problem-sets.html#cb23-9"></a>        <span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb23-10"><a href="problem-sets.html#cb23-10"></a>        <span class="op">+</span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span>NewRound)</span>
<span id="cb23-11"><a href="problem-sets.html#cb23-11"></a>        <span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Record,<span class="dt">y=</span>Surplus<span class="op">$</span>TS[Part],<span class="dt">group=</span>Part,<span class="dt">color=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb23-12"><a href="problem-sets.html#cb23-12"></a>        <span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;Cumulative surplus&quot;</span>)</span>
<span id="cb23-13"><a href="problem-sets.html#cb23-13"></a>        )</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="problem-sets.html#cb24-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb24-2"><a href="problem-sets.html#cb24-2"></a>D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Round,Part)</span>
<span id="cb24-3"><a href="problem-sets.html#cb24-3"></a><span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">FracSurplus =</span> <span class="kw">max</span>(CumlativeSurplus<span class="op">/</span>Surplus<span class="op">$</span>TS[Part],<span class="dt">na.rm=</span>T))</span>
<span id="cb24-4"><a href="problem-sets.html#cb24-4"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Round</th>
<th align="right">Part</th>
<th align="right">FracSurplus</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0.3928571</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">0.7976190</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">0.7976190</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0.7500000</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">2</td>
<td align="right">0.6000000</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">2</td>
<td align="right">0.6600000</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">2</td>
<td align="right">0.8000000</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">2</td>
<td align="right">0.7200000</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">2</td>
<td align="right">0.7200000</td>
</tr>
</tbody>
</table>
<ol start="5" style="list-style-type: decimal">
<li>Write a short paragraph telling me your main findings. When needed, make reference to the three plots you made.</li>
</ol>
<p><strong>Solution</strong> We studied a market experiment in which buyers and sellers traded a fictitious good. In the second part of the experiment, the supply curve shifted up by $2 (see first Figure). In general, traded prices were above the equilibrium, but they moved up on average in the second part:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="problem-sets.html#cb25-1"></a>(</span>
<span id="cb25-2"><a href="problem-sets.html#cb25-2"></a><span class="kw">ggplot</span>(D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Status<span class="op">==</span><span class="st">&quot;t&quot;</span>),<span class="kw">aes</span>(<span class="dt">x=</span>Market_Price,<span class="dt">color=</span><span class="kw">paste</span>(<span class="st">&quot;Part&quot;</span>,Part),<span class="dt">linetype=</span><span class="st">&quot;Data&quot;</span>))</span>
<span id="cb25-3"><a href="problem-sets.html#cb25-3"></a><span class="op">+</span><span class="kw">stat_ecdf</span>()</span>
<span id="cb25-4"><a href="problem-sets.html#cb25-4"></a><span class="op">+</span><span class="kw">geom_vline</span>(<span class="dt">data=</span>EQ,<span class="kw">aes</span>(<span class="dt">xintercept=</span>Peq,<span class="dt">color=</span>Part,<span class="dt">linetype=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb25-5"><a href="problem-sets.html#cb25-5"></a><span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb25-6"><a href="problem-sets.html#cb25-6"></a><span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;p&quot;</span>)<span class="op">+</span><span class="kw">ylab</span>(<span class="kw">TeX</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">Pr(</span><span class="ch">\\</span><span class="st">mathrm{Trade Price}) </span><span class="ch">\\</span><span class="st">leq p$&quot;</span>))</span>
<span id="cb25-7"><a href="problem-sets.html#cb25-7"></a></span>
<span id="cb25-8"><a href="problem-sets.html#cb25-8"></a></span>
<span id="cb25-9"><a href="problem-sets.html#cb25-9"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<ol start="6" style="list-style-type: decimal">
<li>(6260 students only) The model also makes predictions about how many items each seller will sell, and how many items each buyer will buy. Comment on how well the theory is predicting these individual-level quantities (Again, this is another deliberately vague question. I am looking to see how you approach this problem)</li>
</ol>
<p><strong>Solution</strong></p>
<p>First, let’s make a list of how many items each buyer and seller should trade in equilibrium</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="problem-sets.html#cb26-1"></a>Parameters&lt;-(Parameters</span>
<span id="cb26-2"><a href="problem-sets.html#cb26-2"></a>             <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">ShouldBuy =</span> v<span class="op">&gt;=</span><span class="st"> </span>EQ<span class="op">$</span>Peq[Part],</span>
<span id="cb26-3"><a href="problem-sets.html#cb26-3"></a>                        <span class="dt">ShouldSell =</span> c<span class="op">&lt;=</span><span class="st"> </span>EQ<span class="op">$</span>Peq[Part])</span>
<span id="cb26-4"><a href="problem-sets.html#cb26-4"></a>)</span>
<span id="cb26-5"><a href="problem-sets.html#cb26-5"></a>EQQdemand&lt;-Parameters <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(idBuyer,Part) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">qEQ =</span> <span class="kw">sum</span>(<span class="dv">1</span><span class="op">*</span>ShouldBuy)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">ID=</span>idBuyer,<span class="dt">Role=</span><span class="st">&quot;Buyer&quot;</span>) </span>
<span id="cb26-6"><a href="problem-sets.html#cb26-6"></a>EQQsupply&lt;-Parameters <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(idSeller,Part) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">qEQ =</span> <span class="kw">sum</span>(<span class="dv">1</span><span class="op">*</span>ShouldSell)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">ID=</span>idSeller,<span class="dt">Role=</span><span class="st">&quot;Seller&quot;</span>) </span>
<span id="cb26-7"><a href="problem-sets.html#cb26-7"></a>EQindividual&lt;-<span class="kw">rbind</span>(EQQdemand,EQQsupply)[,<span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>,<span class="st">&quot;Part&quot;</span>,<span class="st">&quot;qEQ&quot;</span>,<span class="st">&quot;Role&quot;</span>)] </span>
<span id="cb26-8"><a href="problem-sets.html#cb26-8"></a><span class="co">#knitr::kable((EQindividual))</span></span></code></pre></div>
<p>Now, let’s work out what these were empirically:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="problem-sets.html#cb27-1"></a>TradeCounts&lt;-(D <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Status<span class="op">==</span><span class="st">&quot;t&quot;</span>)</span>
<span id="cb27-2"><a href="problem-sets.html#cb27-2"></a>              <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Round,Part,ID,Role)</span>
<span id="cb27-3"><a href="problem-sets.html#cb27-3"></a>              <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">ntrades=</span><span class="kw">n</span>())</span>
<span id="cb27-4"><a href="problem-sets.html#cb27-4"></a>              <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(EQindividual,<span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>,<span class="st">&quot;Part&quot;</span>,<span class="st">&quot;Role&quot;</span>))</span>
<span id="cb27-5"><a href="problem-sets.html#cb27-5"></a>              <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Part,qEQ,Round)</span>
<span id="cb27-6"><a href="problem-sets.html#cb27-6"></a>              <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">mtrades=</span><span class="kw">mean</span>(ntrades,<span class="dt">na.rm=</span>T,<span class="dt">sdtrades=</span><span class="kw">sd</span>(ntrades)))</span>
<span id="cb27-7"><a href="problem-sets.html#cb27-7"></a>              )</span>
<span id="cb27-8"><a href="problem-sets.html#cb27-8"></a></span>
<span id="cb27-9"><a href="problem-sets.html#cb27-9"></a>(<span class="kw">ggplot</span>(<span class="dt">data=</span>TradeCounts,<span class="kw">aes</span>(<span class="dt">x=</span>Round,<span class="dt">y=</span>mtrades,<span class="dt">color=</span><span class="kw">paste</span>(qEQ)))</span>
<span id="cb27-10"><a href="problem-sets.html#cb27-10"></a>  <span class="op">+</span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype=</span><span class="st">&quot;Data&quot;</span>),<span class="dt">size=</span><span class="dv">1</span>)</span>
<span id="cb27-11"><a href="problem-sets.html#cb27-11"></a>  <span class="op">+</span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span><span class="dv">1</span>,<span class="dt">color=</span><span class="st">&quot;1&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb27-12"><a href="problem-sets.html#cb27-12"></a>  <span class="op">+</span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span><span class="dv">2</span>,<span class="dt">color=</span><span class="st">&quot;2&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb27-13"><a href="problem-sets.html#cb27-13"></a>  <span class="op">+</span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept=</span><span class="dv">3</span>,<span class="dt">color=</span><span class="st">&quot;3&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;Equilibrium&quot;</span>))</span>
<span id="cb27-14"><a href="problem-sets.html#cb27-14"></a>  <span class="op">+</span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept=</span><span class="fl">5.5</span>),<span class="dt">color=</span><span class="st">&quot;black&quot;</span>,<span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb27-15"><a href="problem-sets.html#cb27-15"></a>  <span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb27-16"><a href="problem-sets.html#cb27-16"></a>  <span class="op">+</span><span class="kw">xlab</span>(<span class="st">&quot;Mean number of trades&quot;</span>)</span>
<span id="cb27-17"><a href="problem-sets.html#cb27-17"></a>  <span class="op">+</span><span class="kw">theme_bw</span>()</span>
<span id="cb27-18"><a href="problem-sets.html#cb27-18"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>The theory is not predicting the number of items each player will trade well. For example, in the first part of the experiment, the players who should make 2 trades on average trade more than those who should trade two.</p>
</div>
</div>
</div>
<div id="risk" class="section level2">
<h2><span class="header-section-number">3.3</span> Risk</h2>
<div id="questions" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Questions</h3>
<ol style="list-style-type: decimal">
<li><p>Calculate the expected value of each option, and the expected utility of each option, assuming that everyone have utility function <span class="math inline">\(u(x)=x^{0.2}\)</span></p></li>
<li><p>The <em>certainty equivalent</em> of a lottery is the dollar amount $C that a person would accept with certainty instead of the lottery itself. For example, if the lottery I hsve chosen is $1 with probability 50%, and $0 otherwise, then my certainty equivalent is defined as:
<span class="math display">\[
u(C)=0.5u(1)+0.5u(0)
\]</span>
For our utility function <span class="math inline">\(u(x) =x^{0.2}\)</span>, we can solve for the certainty equivalent as follows:
<span class="math display">\[
\begin{aligned}
C^{r}&amp;=0.5\times 0^{r}+0.5\times 1^{r}\\
C&amp;=\left(0.5\times 0^{r}+0.5\times 1^{r}\right)^{1/r}\\
\end{aligned}
\]</span>
and so <span class="math inline">\(0.5^{1/0.2}=0.5^5\approx\$0.031\)</span>
Produce a plot with the expected value of each choice on the horizontal axis, and the certainty equivalent of each choice on the vertical axis. Incluse a <span class="math inline">\(45^\circ\)</span> line (i.e. plot <span class="math inline">\(y=x\)</span>), and explain the relationship between this line and the points that you have plot.</p></li>
<li><p>On a separate graph, plot the expected value of choice a (horizontal axis) against the expected value of choice b (vertical axis). Also plot the certainty equivalents. Add a <span class="math inline">\(45^\circ\)</span> line. What does a point being above (or to the right of) this line mean?</p></li>
</ol>
<p>4u. (undergrad students only) For each participant in the experiment, determine whether there decisions look more like maximizing <span class="math inline">\(E(X)\)</span> or <span class="math inline">\(E(u(x))\)</span>. Report the fraction of subjects for each type. This is a deliberately vague question. <em>Hint:</em> Start by thinking about the predictions for each of these models.</p>
<p>4m. (masters students only) Estimate <span class="math inline">\(r\)</span> for all participants in the experiment, where <span class="math inline">\(r\)</span> is the parameter in the utility function <span class="math inline">\(u(x)=x^r\)</span>. Consider values for <span class="math inline">\(r\)</span> in the range <span class="math inline">\((0.1,1.5)\)</span></p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="masters-only-content-econ-6260.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
